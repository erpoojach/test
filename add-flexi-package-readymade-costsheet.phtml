<?php $model = new Travel_Model_TblPackage(); ?>
<link rel="stylesheet" href="<?php echo $this->baseUrl('public/assets/css/plugins/accordion.css'); ?>">
<link rel="stylesheet" href="<?php echo $this->baseUrl('public/assets/css/plugins/tab.css'); ?>">
<link rel="stylesheet" href="<?php echo $this->baseUrl('public/assets/css/plugins/summernote.css'); ?>">
<link rel="stylesheet" href="<?php echo $this->baseUrl('public/assets/css/plugins/custom_smart_wizard.css'); ?>">
<link rel="stylesheet" href="<?php echo $this->baseUrl('public/assets/css/autosuggest-jquery-ui.css'); ?>">
<!-- Date & Time Picker Library Script Start -->
<script src="<?php echo $this->baseUrl('public/assets/js/jquery.datetimepicker.js'); ?>"></script>
<!-- Date & Time Picker Library Script End -->
<style>
    .readonly {
        cursor: default!important;
    }
</style>
<?php
error_reporting(1);
$params = $this->params;
$objPackage = new Travel_Model_TblPackage();
$flexiPackageList = $this->flexiPackageList;
$edit_flexi_id = $flexiPackageList['TPSysId'];
$packageCancelPolicyList = $this->packageCancelPolicyList;
if (@$flexiPackageList['MasterRefId'] == '0') {
    $childpackarr = $objPackage->getChildPackageList(@$flexiPackageList['TPSysId']);
} else {
    $childpackarr = $objPackage->getChildPackageList(@$flexiPackageList['MasterRefId']);
}
for ($i = 0; $i < count(@$childpackarr); $i++) {
    $reslastint[] = @$childpackarr[$i]['TPSysId'];
    $reseconomyid[@$childpackarr[$i]['EconomyMask']] = @$childpackarr[$i]['TPSysId'];
}
$mptypearr = $objPackage->getMarketPlaceList();
$currencyarr = $objPackage->getCurrencyList();
for ($h = 0; $h < count(@$reslastint); $h++) {
    $marketratearr[@$reslastint[$h]] = $objPackage->getPackageMPArr(@$reslastint[$h]);
    $packratearr[@$reslastint[$h]] = $objPackage->getPackageRateArr(@$reslastint[$h]);
}
$displayMarArr = array();
foreach ($marketratearr as $arrayKey => $arrayValID) {
    foreach ($arrayValID as $arrayVal) {
        $marketPlaceId = $arrayVal['MarketPlaceId'];
        $fromDate = $arrayVal['FromDate']->format("Ymd");
        $toDate = $arrayVal['ToDate']->format("Ymd");
        $totalPax = (int) $arrayVal['Pax'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['TPIntSysId'] = $arrayVal['TPIntSysId'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['AgencySysId'] = $arrayVal['AgencySysId'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['FromDate'] = $arrayVal['FromDate'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['ToDate'] = $arrayVal['ToDate'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CurrencyType'] = $arrayVal['CurrencyType'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['TourType'] = $arrayVal['TourType'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['PackCategoryId'] = $arrayVal['PackCategoryId'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MarkType'] = $arrayVal['MarkType'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MarketPlaceId'] = $arrayVal['MarketPlaceId'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MarketPlace'] = $arrayVal['MarketPlace'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['Permission'] = $arrayVal['Permission'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MarkPercent'] = $arrayVal['MarkPercent'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['TotalCost'] = $arrayVal['TotalCost'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostPerPerson'] = $arrayVal['CostPerPerson'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostPPSO'] = $arrayVal['CostPPSO'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostPPTO'] = $arrayVal['CostPPTO'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostExtraBed'] = $arrayVal['CostExtraBed'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostChildWithoutBed'] = $arrayVal['CostChildWithoutBed'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['Tax'] = $arrayVal['Tax'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['ExcludedPercent'] = $arrayVal['ExcludedPercent'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['PricePerPerson'] = $arrayVal['PricePerPerson'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CreateDate'] = $arrayVal['CreateDate'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['UpdateDate'] = $arrayVal['UpdateDate'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['IsMarkForDel'] = $arrayVal['IsMarkForDel'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['IsActive'] = $arrayVal['IsActive'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MealPlanType'] = $arrayVal['MealPlanType'];
        if($totalPax == 2){
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostPPDO'] = $arrayVal['CostPPDO'];
        }
        if($totalPax == 4){
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostFourO'] = $arrayVal['CostPPDO'];
        }
        if($totalPax == 6){
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostSixO'] = $arrayVal['CostPPDO'];
        }
        if($totalPax == 8){
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostEightO'] = $arrayVal['CostPPDO'];
        }
        if($totalPax == 10){
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostTenO'] = $arrayVal['CostPPDO'];
        }
        if($totalPax == 12){
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostTwelveO'] = $arrayVal['CostPPDO'];
        }
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostInfent'] = $arrayVal['CostInfent'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['FixedDepartureInventory'] = $arrayVal['FixedDepartureInventory'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['AdultCostExtraBed'] = $arrayVal['AdultCostExtraBed'];
        $displayMarArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['Symbol'] = $arrayVal['Symbol'];
    }
}
//echo "<pre>";print_r($packratearr);exit;
$displayPackArr = array();
foreach ($packratearr as $arrayKey => $arrayValID) {
    foreach ($arrayValID as $arrayVal) {
        $marketPlaceId = $arrayVal['MarketPlaceId'];
        $fromDate = $arrayVal['StartDate']->format("Ymd");
        $toDate = $arrayVal['ValidTill']->format("Ymd");
        $totalPax = (int) $arrayVal['Pax'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['TPSysId'] = $arrayVal['TPSysId'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['StartDate'] = $arrayVal['StartDate'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['ValidTill'] = $arrayVal['ValidTill'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MasterRefId'] = $arrayVal['MasterRefId'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CurrencyType'] = $arrayVal['CurrencyType'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['TourType'] = $arrayVal['TourType'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['PackCategoryId'] = $arrayVal['PackCategoryId'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['TotalCost'] = $arrayVal['TotalCost'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostPerPerson'] = $arrayVal['CostPerPerson'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostSO'] = $arrayVal['CostSO'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostTO'] = $arrayVal['CostTO'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostExtraBed'] = $arrayVal['CostExtraBed'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostWithoutBed'] = $arrayVal['CostWithoutBed'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CreateDate'] = $arrayVal['CreateDate'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['UpdateDate'] = $arrayVal['UpdateDate'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['IsMarkForDel'] = $arrayVal['IsMarkForDel'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['IsActive'] = $arrayVal['IsActive'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['IsAprooved'] = $arrayVal['IsAprooved'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['MarketPlaceId'] = $arrayVal['MarketPlaceId'];
        if($totalPax == 2){
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostDO'] = $arrayVal['CostDO'];
        } 
        if($totalPax == 4){
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostFourO'] = $arrayVal['CostDO'];    
        }
        if($totalPax == 6){
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostSixO'] = $arrayVal['CostDO'];    
        }
        if($totalPax == 8){
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostEightO'] = $arrayVal['CostDO'];    
        }
        if($totalPax == 10){
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostTenO'] = $arrayVal['CostDO'];    
        }
         if($totalPax == 12){
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostTwelveO'] = $arrayVal['CostDO'];    
        }
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['CostInfent'] = $arrayVal['CostInfent'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['FixedDepartureInventory'] = $arrayVal['FixedDepartureInventory'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['AdultCostExtraBed'] = $arrayVal['AdultCostExtraBed'];
        $displayPackArr[$arrayKey][$fromDate . '-' . $toDate][$marketPlaceId]['Symbol'] = $arrayVal['Symbol'];
    }
}
//echo "<pre>";print_r($displayPackArr);exit;
$selected_market_place = @$marketratearr[$edit_flexi_id][0]['MarketPlaceId'] . '_' . @trim($marketratearr[$edit_flexi_id][0]['MarketPlace']);
$CurrencyHelperObj = Zend_Controller_Action_HelperBroker::getStaticHelper('Currency');
$baseCurrencySymbol = $CurrencyHelperObj->getLoggedInAgencyBaseCurrency();
$baseCurrencyId = $CurrencyHelperObj->getLoggedInAgencyBaseCurrencyId();
//echo '<pre>';
//print_r($selected_market_place);
//print_r($packratearr['603']);
//echo '</pre>';
//die();

if (isset($params) && !empty($params)) {
    $from_date = isset($params['from_date']) && !empty($params['from_date']) ? $params['from_date'] : '';
    $to_date = isset($params['to_date']) && !empty($params['to_date']) ? $params['to_date'] : '';
    $ComssnType = isset($params['ComssnType']) && !empty($params['ComssnType']) ? $params['ComssnType'] : '';
    $b2b = isset($params['b2b']) && !empty($params['b2b']) ? $params['b2b'] : '';
    $b2c = isset($params['b2c']) && !empty($params['b2c']) ? $params['b2c'] : '';
    $inventory = isset($params['inventory']) && !empty($params['inventory']) ? $params['inventory'] : '';
}
if (!empty($flexiPackageList['IsFixedDeparturePackage']) && $flexiPackageList['IsFixedDeparturePackage'] == 1) {
    $inventorydisable = '';
    $hideTodate = 'style="display:none;"';
    $to_date = $from_date; // in case of fixed departure override date
} else {
    $inventorydisable = 'disabled="disabled"';
    $hideTodate = '';
}
?>
<div class="modal fade" id="myModa1Modify" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Please select category</h4>
            </div>
            <div class=" panel  panel-info   whbg">

                <?php foreach ($mptypearr as $mptype) {  //echo '<pre>'; print_r($mptype); echo '</pre>'; ?>
                    <div class="panel-heading mptypedisp_<?php echo $mptype['MPType']; ?>" style="display: <?php echo ($mptype['MPType'] == 2) ? 'none' : 'block'; ?>">
                        <h3 class="panel-title"><?php echo $mptype['Title'] . ' Rates'; ?></h3>
                    </div>
                    <div class="modal-body mptypedisp_<?php echo $mptype['MPType']; ?>" style="text-align:center; display: <?php echo ($mptype['MPType'] == 2) ? 'none' : 'block'; ?>">
                        <?php
                        $secureCode = $model->GenrateSecureCode(@$reseconomyid[1], 0);
                        $secureCode1 = $model->GenrateSecureCode(@$reseconomyid[2], 0);
                        $secureCode2 = $model->GenrateSecureCode(@$reseconomyid[3], 0);
                        if (@$reseconomyid[1] > 0) {
                            ?>
                            <a href="<?php echo $this->baseUrl('package/view-flexi-final-package-readymade/id/' . @$reseconomyid[1] . '/MpType/' . $mptype['MPType'] . '/code/' . $secureCode); ?>" target="_blank"  type="button" class="btn btn-info btn-sm" >Standard</a> 
                        <?php } if (@$reseconomyid[2] > 0) { ?>
                            <a href="<?php echo $this->baseUrl('package/view-flexi-final-package-readymade/id/' . @$reseconomyid[2] . '/MpType/' . $mptype['MPType'] . '/code/' . $secureCode1); ?>" target="_blank" type="button" class="btn btn-info btn-sm" >Deluxe</a>
                        <?php } if (@$reseconomyid[3] > 0) { ?>
                            <a href="<?php echo $this->baseUrl('package/view-flexi-final-package-readymade/id/' . @$reseconomyid[3] . '/MpType/' . $mptype['MPType'] . '/code/' . $secureCode2); ?>" target="_blank" type="button" class="btn btn-info btn-sm" >Luxury</a>
                        <?php } ?>
                        <div class="clear"></div>
                    </div>
                <?php } ?>

            </div>
        </div>
    </div>
</div>
<section id="min-wrapper" class="active">
    <div id="main-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <!--Top header start-->
                    <h3 class="ls-top-header">Create Package</h3>
                    <!--Top header end -->
                    <!--Top breadcrumb start -->
                    <ol class="breadcrumb">
                        <li><a href="#"><i class="fa fa-home"></i></a></li>
                        <li class="active">My Inventory</li>
                        <li class="active"><a href="<?php echo $this->baseUrl('package'); ?>">Packages</a></li>
                        <li class="active">Cost Sheet</li>
                        <div class="clear"></div>
                    </ol>
                    <!--Top breadcrumb start -->
                </div>
            </div>
            <!-- Main Content Element  Start-->
            <div class="row">
                <div class="col-md-12">
                    <input type="hidden" accept="packageId" id="packageId" value="<?php echo @$flexiPackageList['TPSysId'] ?>">
                    <input type="hidden" accept="multipackres" id="multipackres" value="<?php echo base64_encode(json_encode(@$reslastint)) ?>">
                    <?php echo $this->partial('package/toptab.phtml', array('TPSysId' => $flexiPackageList['TPSysId'])); ?>
                </div>

                <div class="col-md-12">
                    <div class="alert alert-info">
                        <div class="col-md-8  no-margin no-padding">
                            <h4 class="no-margin"><?php echo strtoupper(@$flexiPackageList['Title']) ?></h4>
                        </div>
                        <div class="clear"></div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="panel panel-dark">
                        <div class=" alert whbg">
                            <div class=" panel  panel-info   whbg">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Manage Rates/ Season</h3>
                                </div>



                                <div class="col-md-12 no-padding costomizetab">
                                    <form name="" id="search_add_rates" action="<?php echo $this->baseUrl('package/add-flexi-package-readymade-costsheet/id/' . $edit_flexi_id); ?>" method="post" enctype="multipart/form-data" autocomplete="off">
                                        <table class="table table-bordered no-margin" id="RowsGroup">
                                            <tr>
                                                <td colspan="8">Add Season</td>
                                            </tr>
                                            <tr>
                                                <td>Currency<?php echo MANDATORY_SIGN; ?> </td>
                                                <td colspan="6"><select id="currency" name="currency" onchange="getcurrencyexchangerateAllPkg();" style="width:30%;" class="demo-default select-country" placeholder="Select">
                                                        <option value="">Select</option>
                                                        <?php for ($p = 0; $p < count($currencyarr); $p++) { ?>
                                                            <option value="<?php echo $currencyarr[$p]['CurrencyType'] ?>_<?php echo $currencyarr[$p]['Symbol'] ?>" <?php
                                                            if (@$currencyarr[$p]['CurrencyType'] == @$packratearr[@$edit_flexi_id][0]['CurrencyType']) {
                                                                echo 'selected';
                                                            } elseif (@$currencyarr[$p]['CurrencyType'] == (isset($params['currency']) && !empty($params['currency']) ? $params['currency'] : $baseCurrencyId . '_' . $baseCurrencySymbol)) {
                                                                echo 'selected';
                                                            }
                                                            ?>><?php echo $currencyarr[$p]['Symbol'] ?></option>     
                                                                <?php } ?>
                                                    </select></td>

                                            </tr>
                                            <tr>
                                                <td><?php echo!empty($hideTodate) ? 'Date' : 'From'; ?><?php echo MANDATORY_SIGN; ?> </td>
                                                <td <?php echo $hideTodate; ?>>To<?php echo MANDATORY_SIGN; ?></td>
                                                <td>Mark UP<?php echo MANDATORY_SIGN; ?></td>
                                                <td>B2C (<?php echo $baseCurrencySymbol; ?>)</td>
                                                <td>B2B (<?php echo $baseCurrencySymbol; ?>)</td>
                                                <td style="display:none;">Inventory</td>
                                                <td>&nbsp;</td>
                                            </tr>

                                            <?php
                                            if ($from_date) {
                                                for ($i = 0; $i < count($from_date); $i++) {
                                                    ?>
                                                    <tr id="Row<?= $i ?>">
                                                        <td><input name="from_date[]" id="from_date<?= $i ?>" value="<?= (isset($from_date[$i]) && !empty($from_date[$i]) ? $from_date[$i] : '') ?>" type="text" class="form-control ratetxtwidth70 whbg "></td>
                                                        <td <?php echo $hideTodate; ?>><input name="to_date[]" id="to_date<?= $i ?>" value="<?= (isset($to_date[$i]) && !empty($to_date[$i]) ? $to_date[$i] : '') ?>" type="text" class="form-control ratetxtwidth70 whbg " ></td>
                                                        <td>
                                                            <select id="ComssnType<?= $i ?>" name="ComssnType[]" class="form-control" placeholder="Select" >                        
                                                                <option value="FixedAmount" <?= (isset($ComssnType[$i]) && $ComssnType[$i] == 'FixedAmount' ? 'selected' : '') ?>>Fixed Amount</option>
                                                                <option value="FixedPercent" <?= (isset($ComssnType[$i]) && $ComssnType[$i] == 'FixedPercent' ? 'selected' : '') ?>>Fixed %</option>
                                                            </select>

                                                        </td>
                                                        <td><input name="b2c[]" index="<?= $i ?>" id="b2c<?= $i ?>" value="<?= (isset($b2c[$i]) && ($b2c[$i] >= 0) ? $b2c[$i] : '') ?>" onkeypress="return isNumber(event);" type="text" class="form-control ratetxtwidth70 whbg markupvalidate"></td>
                                                        <td><input name="b2b[]" index="<?= $i ?>" id="b2b<?= $i ?>" value="<?= (isset($b2b[$i]) && ($b2b[$i] >= 0) ? $b2b[$i] : '') ?>" onkeypress="return isNumber(event);" type="text" class="form-control ratetxtwidth70 whbg markupvalidate"></td>
                                                        <td style="display:none;"><input name="inventory[]" <?= $inventorydisable ?> id="inventory<?= $i ?>" value="<?= (isset($inventory[$i]) && !empty($inventory[$i]) ? $inventory[$i] : '') ?>" type="text" class="form-control ratetxtwidth70 whbg"></td>
                                                        <td><span class="removeButton btn ls-red-btn btn-sm" title="Remove"><i class="fa fa-trash-o"></i></span></td>
                                                    </tr>
                                                <?php
                                                }
                                            }
                                            ?>

                                        </table>

                                        <table width="100%" border="0" class="table">
                                            <tr>
                                                <td align="right"><span class="add " id="addButton" style="cursor:pointer;">Add More Season</span></td>
                                            </tr>
                                            <tr>
                                                <td align="right"><input type="submit" value="Enter Markup" class="btn btn-warning btn-sm"></td>
                                            </tr>
                                        </table>
                                    </form>
                                </div>
                                <div class="col-md-12 no-padding costomizetab search_add_rates_data">
                                    <?php
                                    //echo '<pre>';print_r($params);echo '</pre>'; 
                                    if (isset($params) && !empty($params)) {
                                        ?>
                                        <table width="100%">
                                            <?php
                                            if ($from_date) {
                                                foreach ($from_date as $ks => $vls) {
                                                    if ($ComssnType[$ks] == 'FixedAmount') {
                                                        $markuptype = 'Fixed Amt.';
                                                    } else {
                                                        $markuptype = 'Fixed %';
                                                    }
                                                    ?>
                                                    <tr>
                                                        <td>
                                                            <table  class="table table-bordered table-bottomless">
                                                                <tr>
                                                                    <td align="center">Season <?= $ks + 1 ?>: &nbsp;&nbsp; <?= $from_date[$ks] ?> To <?= $to_date[$ks] ?></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="center">
                                                                        <input type="hidden" id="ComssnType<?= $ks ?>" value="<?= $ComssnType[$ks] ?>" name="ComssnType[]">
                                                                        <?php
                                                                        $IsB2BRates = 0;
                                                                        for ($incPack = 1; $incPack <= 3; $incPack++) {
                                                                            if (@$reseconomyid[$incPack] > 0) {
                                                                                $stdpacklist = $objPackage->getFlexiPackageList(@$reseconomyid[$incPack]);
                                                                                ?>                       
                                                                                <div class="col-md-12 no-padding">
                                                                                    <div class="panel panel-default" style="margin-bottom:0; border-bottom:1px solid #b4b3b3;">
                                                                                        <div class="panel-heading" >
                                                                                            <?php
                                                                                            if (@$stdpacklist['EconomyMask'] == '1') {
                                                                                                $flexipacres = 'Standard';
                                                                                            }
                                                                                            if (@$stdpacklist['EconomyMask'] == '2') {
                                                                                                $flexipacres = 'Deluxe';
                                                                                            }
                                                                                            if (@$stdpacklist['EconomyMask'] == '3') {
                                                                                                $flexipacres = 'Luxury';
                                                                                            }
                                                                                            ?>
                                                                                            <h3 class="panel-title" onclick="clickaccordion(<?php echo $stdpacklist['EconomyMask']; ?>,<?= $ks ?>);"> Click here to update  <?php echo $flexipacres; ?> category rate</h3>
                                                                                            <input type="hidden" id="accdnid_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" name="accdnid_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" value="active">
                                                                                            <ul class="panel-control">
                                                                                                <li><a id="a_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" class="minus active" href="javascript:void(0)"><i id="i_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" class="fa fa-angle-down large"></i></a></li>
                                                                                                <!--<li><a class="close-panel" href="javascript:void(0)"><i class="fa fa-times"></i></a></li>!-->
                                                                                            </ul>
                                                                                        </div>

                                                                                        <div class="panel-body no-padding active" id="accdresid_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" style="display:none; ">
                                                                                            <div class="col-md-12 no-padding no-margin alert">
                                                                                                <div class="panel-body">
                                                                                                    <table class="table table-bordered no-margin" id="costmarkupres_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>">
                                                                                                        <tr class="alert alert-success">
                                                                                                            <!--<th><strong>Validity<br>From Date / To Date</strong></th>-->
                                                                                                            <th colspan="2">Published</th>
                                                                                                            <th>Mark up</th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>2 Pax</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>4 Pax</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>6 Pax</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>8 Pax</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>10 Pax</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>12 Pax</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Single Occupancy <br> Suppliment Cost</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per<br> Adult Extra<br> Bed</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per<br> Child Extra<br> Bed</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per<br>  Child Extra <br>W/o Bed</span></th>
                                                                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per<br> Infant</span></th>                                                    
                                                                                                            <th><strong>Action</strong></th>
                                                                                                        </tr>  

                                                                                                        <tr class="alert alert-warning">
                                                                                                            <!--<td class="text-center">date</td>-->

                                                                                                        <script>

                                                                                                            //    $('#from_date_<?php // echo @$reseconomyid[$incPack];     ?>').datetimepicker({timepicker:false});
                                                                                                            //    $('#to_date_<?php // echo @$reseconomyid[$incPack];     ?>').datetimepicker({timepicker:false});
                                                                                                            //    $('#to_date_<?php // echo @$reseconomyid[$incPack];     ?>,#from_date_<?php //  echo @$reseconomyid[$incPack];     ?>').attr('disabled',true);

                                                                                                            var selector_<?php echo @$reseconomyid[$incPack]; ?> = function (dateStr) {
                                                                                                                var d1 = $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val();
                                                                                                                var d2 = $('#to_date_<?php echo @$reseconomyid[$incPack]; ?>').val();
                                                                                                                var days = 0;
                                                                                                                if (d1 && d2 && d1 != '__/__/____' && d2 != '__/__/____') {
                                                                                                                    var mdy = d1.split('/');
                                                                                                                    if (mdy[1] > 0) {
                                                                                                                        var monthSelection = mdy[1] - 1;
                                                                                                                    } else {
                                                                                                                        var monthSelection = mdy[1];
                                                                                                                    }
                                                                                                                    var d1 = new Date(mdy[2], parseInt(monthSelection), mdy[0]);
                                                                                                                    var mdy2 = d2.split('/');
                                                                                                                    if (mdy2[1] > 0) {
                                                                                                                        var monthSelection2 = mdy2[1] - 1;
                                                                                                                    } else {
                                                                                                                        var monthSelection2 = mdy2[1];
                                                                                                                    }
                                                                                                                    var d2 = new Date(mdy2[2], parseInt(monthSelection2), mdy2[0]);
                                                                                                                    var currentTime = new Date();

                                                                                                                    var dd = currentTime.getDate();
                                                                                                                    var mm = currentTime.getMonth(); //January is 0!
                                                                                                                    var yyyy = currentTime.getFullYear();
                                                                                                                    var currentDate = new Date(yyyy, mm, dd);
                                                                                                                    if (Date.parse(d1) > Date.parse(d2) || Date.parse(d1) < Date.parse(currentDate)) {
                                                                                                                        $("#from_date_<?php echo @$reseconomyid[$incPack]; ?>").val('');
                                                                                                                    }
                                                                                                                    var days = Math.floor((Date.parse(d2) - Date.parse(d1)) / 86400000);
                                                                                                                    if (days > 0) {
                                                                                                                        var days = days;
                                                                                                                    } else {
                                                                                                                        var days = 0;
                                                                                                                    }
                                                                                                                }
                                                                                                                $('#nights').val(days);

                                                                                                            }
                                                                                                            $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').datetimepicker({
                                                                                                                timepicker: false,
                                                                                                                datepicker: true,
                                                                                                                scrollMonth: false,
                                                                                                                scrollInput: false,
                                                                                                                mask: true,
                                                                                                                autoclose: true,
                                                                                                                formatDate: 'd/m/Y',
                                                                                                                format: 'd/m/Y',
                                                                                                                minDate: 0, //yesterday is minimum date(for today use 0 or -1970/01/01)
                                                                                                                maxDate: ($("#to_date_<?php echo @$reseconomyid[$incPack]; ?>").val() != '' && $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() != '__/__/____') ? $("#to_date_<?php echo @$reseconomyid[$incPack]; ?>").val() : false,
                                                                                                                onChangeDateTime: selector_<?php echo @$reseconomyid[$incPack]; ?>,
                                                                                                                onShow: function (ct) {
                                                                                                                    this.setOptions({
                                                                                                                        maxDate: ($("#to_date_<?php echo @$reseconomyid[$incPack]; ?>").val() != '' && $('#to_date_<?php echo @$reseconomyid[$incPack]; ?>').val() != '__/__/____') ? $("#to_date_<?php echo @$reseconomyid[$incPack]; ?>").val() : false
                                                                                                                    });
                                                                                                                }

                                                                                                            });
                                                                                                            $('#to_date_<?php echo @$reseconomyid[$incPack]; ?>').datetimepicker({
                                                                                                                scrollMonth: false,
                                                                                                                scrollInput: false,
                                                                                                                timepicker: false,
                                                                                                                datepicker: true,
                                                                                                                mask: true, autoclose: true,
                                                                                                                minDate: ($('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() != '' && $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() != '__/__/____') ? $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() : false,
                                                                                                                formatDate: 'd/m/Y',
                                                                                                                format: 'd/m/Y',
                                                                                                                onChangeDateTime: selector_<?php echo @$reseconomyid[$incPack]; ?>,
                                                                                                                onShow: function (ct) {
                                                                                                                    this.setOptions({
                                                                                                                        minDate: ($('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() != '' && $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() != '__/__/____') ? $('#from_date_<?php echo @$reseconomyid[$incPack]; ?>').val() : false
                                                                                                                    });
                                                                                                                }
                                                                                                            });
                    <?php $sourceCurrencyArr = explode('_', $params['currency']); ?>
                                                                                                        </script>
                                                                                                        <td colspan="2" class="text-center">
                                                                                                            <input name="from_date_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?= (isset($from_date[$ks]) && !empty($from_date[$ks]) ? $from_date[$ks] : '') ?>" id="from_date_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" onkeydown="return false" type="hidden" class="form-control ratetxtwidth70 whbg readonly"><br>
                                                                                                            <input name="to_date_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?= (isset($to_date[$ks]) && !empty($to_date[$ks]) ? $to_date[$ks] : '') ?>" id="to_date_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" onkeydown="return false" type="hidden" class="form-control ratetxtwidth70 whbg readonly">
                                                                                                            <input type="hidden" name="inventoryqty_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="inventoryqty_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?= (isset($inventory[$ks]) && !empty($inventory[$ks]) ? $inventory[$ks] : '') ?>" onkeypress="return isNumber(event);">
                                                                                                            <strong>Sourcing Cost <span class="currencyres"><?php echo $sourceCurrencyArr[1]; ?></span><i class="fa fa-long-arrow-right"></i></strong></td>
                                                                                                        <td class="text-center">&nbsp;</td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_1_<?php echo @$reseconomyid[$incPack] . $ks ?> copypaste" index="1_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" name="CostTwoPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostTwoPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack]; ?>', '<?= $ks ?>', 'CostTwoPax')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_2_<?php echo @$reseconomyid[$incPack] . $ks ?> copypaste" index="2_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" name="CostFourPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostFourPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack]; ?>', '<?= $ks ?>', 'CostFourPax')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_3_<?php echo @$reseconomyid[$incPack] . $ks ?> copypaste" index="3_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" name="CostSixPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostSixPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack]; ?>', '<?= $ks ?>', 'CostSixPax')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_4_<?php echo @$reseconomyid[$incPack] . $ks ?> copypaste" index="4_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" name="CostEightPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostEightPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack]; ?>', '<?= $ks ?>', 'CostEightPax')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_5_<?php echo @$reseconomyid[$incPack] . $ks ?> copypaste" index="5_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" name="CostTenPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostTenPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack]; ?>', '<?= $ks ?>', 'CostTenPax')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_6_<?php echo @$reseconomyid[$incPack] . $ks ?> copypaste" index="6_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" name="CostTwelvePax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostTwelvePax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack]; ?>', '<?= $ks ?>', 'CostTwelvePax')">
                                                                                                        </td>

                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_7_<?php echo @$reseconomyid[$incPack] . $ks ?>  copypaste" name="CostExtraSO_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostExtraSO_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'CostExtraSO')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_8_<?php echo @$reseconomyid[$incPack] . $ks ?>  copypaste" name="CostPerAdultExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostPerAdultExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['AdultCostExtraBed'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'CostPerAdultExtraBed')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_9_<?php echo @$reseconomyid[$incPack] . $ks ?>  copypaste" name="CostPerChildExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostPerChildExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostSO'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'CostPerChildExtraBed')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="input0 form-control whbg pax_10_<?php echo @$reseconomyid[$incPack] . $ks ?>  copypaste" name="CostPerChildWithExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostPerChildWithExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostExtraBed'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'CostPerChildWithExtraBed')">
                                                                                                        </td>
                                                                                                        <td class="text-center small">
                                                                                                            <input type="text" class="form-control whbg " name="CostPerInfent_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="CostPerInfent_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostWithoutBed'] ?>" onkeypress="return isNumber(event);" onchange="return updatepackrate('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'CostPerInfent')">
                                                                                                        </td>
                                                                                                        <td class="text-center small" style="display: none"></td>
                                                                                                        <td>&nbsp;</td>
                                                                                                        </tr>
                                                                                                        <tr class="alert alert-warning">                                                                    
                                                                                                            <td colspan="2" class="text-center"><strong><?php echo $baseCurrencySymbol; ?> <i class="fa fa-long-arrow-right"></i></strong></td>
                                                                                                            <td class="text-center">&nbsp;</td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostTwoPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostTwoPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostTO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostFourPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostFourPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostSixPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostSixPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostEightPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostEightPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostTenPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostTenPax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostTwelvePax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostTwelvePax_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>

                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostExtraSO_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostExtraSO_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostDO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostPerAdultExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostPerAdultExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['AdultCostExtraBed'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>

                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostPerChildExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostPerChildExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostSO'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostPerChildWithExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostPerChildWithExtraBed_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostExtraBed'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small">
                                                                                                                <input type="text" class="form-control whbg " name="NewCostPerInfent_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" id="NewCostPerInfent_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>" value="<?php echo @$stdpacklist['CostWithoutBed'] ?>" onkeypress="return isNumber(event);" readonly>
                                                                                                            </td>
                                                                                                            <td class="text-center small" style="display: none"></td>
                                                                                                            <td>&nbsp;</td>
                                                                                                        </tr>
                                                                                                        <!--================================ B2C panels ==============================-->
                    <?php if ($b2c[$ks] >= 0 && $b2c[$ks] != '') { ?>
                                                                                                            <tr>
                                                                                                                <td colspan="2" nowrap>B2C Sale Price </br><?= $markuptype ?> <?php echo MANDATORY_SIGN; ?> <i class="fa fa-long-arrow-right"></i> 


                                                                                                                    <select style="display: none" id="marketPlace_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="marketPlace" class="demo-default " placeholder="Select" style="width:100px;">
                                                                                                                        <option value="">Select</option>
                                                                                                                        <?php
                                                                                                                        for ($p = 0; $p < count(@$mptypearr); $p++) {
                                                                                                                            $market_place_with_name = @$mptypearr[$p]['MPType'] . '_' . @trim($mptypearr[$p]['Title']);
                                                                                                                            ?>
                                                                                                                            <option value="<?php echo $market_place_with_name; ?>" <?php if ($market_place_with_name == '1_MY B2C') { ?>selected<?php } ?>><?php echo @$mptypearr[$p]['Title']; ?></option>     
                        <?php } ?>
                                                                                                                    </select>
                                                                                                                </td>                          

                                                                                                                <td style="display: none"><select id="permission_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="permission_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" class="demo-default select-country" placeholder="Select" style="width:100px;">
                                                                                                                        <!--<option value="">Select</option>-->
                                                                                                                        <option value="1">Yes</option>
                                                                                                                        <!--<option value="0">No</option>-->
                                                                                                                    </select>
                                                                                                                </td>
                                                                                                                <td><input type="text" style="width:60px;" value="<?= $b2c[$ks] ?>" class="form-control whbg"  onchange="return updatemarkup('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'B2C')" id="markup_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="markup_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" maxlength="8"></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostTwoPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostTwoPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostFourPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostFourPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostSixPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostSixPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostEightPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostEightPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostTenPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostTenPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostTwelvePaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostTwelvePaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>

                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostExtraSOId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostExtraSOId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerAdultExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostPerAdultExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerChildExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostPerChildExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerChildWithExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostPerChildWithExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerInfentId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="NewCostPerInfentId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td style="width:80px; display: none;">
                                                                                                                    <select id="taxtype_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="taxtype_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" class="demo-default select-country" placeholder="Select" style="width:100px;" onchange="taxRes('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'B2C');">
                                                                                                                        <option value="">Select</option>
                                                                                                                        <option value="Included">Incl.</option>
                                                                                                                        <option value="Excluded" selected="selected">Excl.</option>
                                                                                                                    </select>
                                                                                                                    <input type="text" value="0" class="form-control whbg" maxlength="3" id="taxres_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" name="taxres_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2C" />
                                                                                                                </td>
                                                                                                                <td><a id="B2C_<?php echo @$reseconomyid[$incPack] ?>_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" class="btn btn-success btn-sm tooltipLink"  data-placement="top" data-toggle="tooltip" data-original-title="Add" href="javascript:void(0);" onclick="marketplacerate('<?php echo @$reseconomyid[$incPack] ?>', '<?php echo $stdpacklist['EconomyMask']; ?>', '<?= $ks ?>', 'B2C')"><i class="fa fa-fw fa-arrows"></i></a> </td>
                                                                                                            </tr>
                                                                                                        <?php } ?>

                                                                                                        <!--================================ B2B panels ==============================-->
                    <?php if ($b2b[$ks] >= 0 && $b2b[$ks] != '') { ?>
                                                                                                            <tr>
                                                                                                                <td colspan="2" nowrap>B2B Sale Price</br><?= $markuptype ?> <?php echo MANDATORY_SIGN; ?> <i class="fa fa-long-arrow-right"></i>

                                                                                                                    <select style="display: none" id="marketPlace_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="marketPlace" class="demo-default " placeholder="Select" style="width:100px;">
                                                                                                                        <option value="">Select</option>
                                                                                                                        <?php
                                                                                                                        for ($p = 0; $p < count(@$mptypearr); $p++) {
                                                                                                                            $market_place_with_name = @$mptypearr[$p]['MPType'] . '_' . @trim($mptypearr[$p]['Title']);
                                                                                                                            ?>
                                                                                                                            <option value="<?php echo $market_place_with_name; ?>" <?php if ($market_place_with_name == '2_MY B2B') { ?>selected<?php } ?>><?php echo @$mptypearr[$p]['Title']; ?></option>     
                        <?php } ?>
                                                                                                                    </select>
                                                                                                                </td>                          

                                                                                                                <td style="display: none"><select id="permission_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="permission_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" class="demo-default select-country" placeholder="Select" style="width:100px;">
                                                                                                                        <!--<option value="">Select</option>-->
                                                                                                                        <option value="1">Yes</option>
                                                                                                                        <!--<option value="0">No</option>-->
                                                                                                                    </select>
                                                                                                                </td>
                                                                                                                <td><input type="text" style="width:60px;" value="<?= $b2b[$ks] ?>" class="form-control whbg"  onchange="return updatemarkup('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'B2B')" id="markup_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="markup_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" maxlength="8"></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostTwoPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostTwoPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostFourPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostFourPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostSixPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostSixPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostEightPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostEightPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostTenPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostTenPaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostTwelvePaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostTwelvePaxId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>

                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostExtraSOId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostExtraSOId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerAdultExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostPerAdultExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerChildExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostPerChildExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerChildWithExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostPerChildWithExtraBedId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td><input type="text" class="form-control whbg " id="NewCostPerInfentId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="NewCostPerInfentId_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" onkeypress="return isNumber(event);" readonly></td>
                                                                                                                <td style="width:80px; display: none;">
                                                                                                                    <select id="taxtype_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="taxtype_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" class="demo-default select-country" placeholder="Select" style="width:100px;" onchange="taxRes('<?php echo @$reseconomyid[$incPack] ?>', '<?= $ks ?>', 'B2B');">
                                                                                                                        <option value="">Select</option>
                                                                                                                        <option value="Included">Incl.</option>
                                                                                                                        <option value="Excluded" selected="selected">Excl.</option>
                                                                                                                    </select>
                                                                                                                    <input type="text" value="0" class="form-control whbg" maxlength="3" id="taxres_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" name="taxres_<?php echo @$reseconomyid[$incPack] ?>_<?= $ks ?>_B2B" />
                                                                                                                </td>
                                                                                                                <td><a id="B2B_<?php echo @$reseconomyid[$incPack] ?>_<?php echo $stdpacklist['EconomyMask']; ?>_<?= $ks ?>" class="btn btn-success btn-sm tooltipLink"  data-placement="top" data-toggle="tooltip" data-original-title="Add" href="javascript:void(0);" onclick="marketplacerate('<?php echo @$reseconomyid[$incPack] ?>', '<?php echo $stdpacklist['EconomyMask']; ?>', '<?= $ks ?>', 'B2B')"><i class="fa fa-fw fa-arrows"></i></a> </td>
                                                                                                            </tr>
                    <?php } ?>

                                                                                                    </table>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <?php
                                                                            }
                                                                        }
                                                                        ?>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                <?php
                                                }
                                            }
                                            ?>
                                        </table>
    <?php
}
?>
                                </div>


                                <div class="col-md-12 no-padding costomizetab">
                                    <?php
                                    $IsB2BRates = 0;
                                    for ($incPack = 1; $incPack <= 3; $incPack++) {
                                        if (@$reseconomyid[$incPack] > 0) {
                                            $stdpacklist = $objPackage->getFlexiPackageList(@$reseconomyid[$incPack]);
                                            if (@$stdpacklist['EconomyMask'] == '1') {
                                                $flexipacres = 'Standard';
                                            }
                                            if (@$stdpacklist['EconomyMask'] == '2') {
                                                $flexipacres = 'Deluxe';
                                            }
                                            if (@$stdpacklist['EconomyMask'] == '3') {
                                                $flexipacres = 'Luxury';
                                            }
                                            ?>                       
                                            <div class="col-md-12 no-padding">
                                                <div class="panel-body">
                                                    <table class="table table-bordered no-margin" id="viewcostmarkupres_<?php echo @$reseconomyid[$incPack] ?>">
                                                        <tr class="">
                                                            <th colspan="15"><h3 class="panel-title" onclick="clickaccordion(<?php echo $stdpacklist['EconomyMask']; ?>);"> <?php echo $flexipacres; ?></h3></th>
                                                        </tr>

                                                        <tr class="alert alert-success">
                                                            <th colspan="2">Validity<br>From Date / To Date</th>
                                                            <th>Mark up</th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>2 Pax</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>4 Pax</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>6 Pax</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>8 Pax</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>10 Pax</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost PP <br>12 Pax</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Single Occupancy<br> Suppliment Cost</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per<br> Adult Extra<br> Bed</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per Child<br> Extra Bed</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per Child<br> Extra W/o Bed</span></th>
                                                            <th class="text-center" nowrap><span class="small center-block">Cost-Per Infant</span></th>                                                    
                                                            <th>Action</th>
                                                        </tr>



                                                        <?php
                                                        foreach ($displayMarArr as $keyMarket => $valMarket) {
                                                            $q=0;
                                                            foreach ($valMarket as $arraykeyMarPleace2 => $arraykeyMarVal1) {
                                                                foreach ($arraykeyMarVal1 as $arraykeyMarPleace => $arraykeyMarVal) {
                                                                if($reseconomyid[$incPack] == $keyMarket) {
                                                                $displayPackValue = $displayPackArr[$keyMarket][$arraykeyMarPleace2][$arraykeyMarPleace];
                                                                if ($arraykeyMarVal == '1') {
                                                                    $permres = 'Yes';
                                                                } else {
                                                                    $permres = 'No';
                                                                }

                                                                $Symbol = isset($arraykeyMarVal) ? trim($arraykeyMarVal) : 0;
                                                                $MarketPlaceId = isset($arraykeyMarVal['MarketPlaceId']) ? trim($arraykeyMarVal['MarketPlaceId']) : 0;
                                                                $PackCategoryId = isset($arraykeyMarVal['PackCategoryId']) ? trim($arraykeyMarVal['PackCategoryId']) : 0;
                                                                if ($MarketPlaceId == 2) {
                                                                    $IsB2BRates++;
                                                                }
                                                                if (!empty($displayPackValue['StartDate'])) {
                                                                    $fromstrtotime = $displayPackValue['StartDate']->format('d/m/Y');
                                                                    $fromstrtotime1 = $displayPackValue['StartDate']->format('d-m-Y');
                                                                } else {
                                                                    $fromstrtotime = '';
                                                                }
                                                                if (!empty($displayPackValue['ValidTill'])) {
                                                                    $tostrtotime = $displayPackValue['ValidTill']->format('d/m/Y');
                                                                    $tostrtotime1 = $displayPackValue['ValidTill']->format('d-m-Y');
                                                                } else {
                                                                    $tostrtotime = '';
                                                                }
                                                                if (trim($arraykeyMarVal['MarkType']) == 'FixedAmount') {
                                                                    $markuptype = 'Fix';
                                                                } else {
                                                                    $markuptype = '%';
                                                                }
                                                                ?> 
                                                                <script>
                //                                                                        $(document).ready(function () { 
                                                                    var MarketPlaceIda = '<?php echo $arraykeyMarVal['MarketPlaceId']; ?>';
                                                                    $('.mptypedisp_' + MarketPlaceIda).css('display', 'block');
                //                                                                    }
                                                                </script>
                                                                <tr class="<?php echo @$reseconomyid[$incPack] ?>_<?php echo @$fromstrtotime1 ?>_<?php echo @$tostrtotime1 ?>_<?php echo $MarketPlaceId ?>_<?php echo $PackCategoryId ?>">                                          

                                                                    <th bgcolor="#e7f9ef" colspan="3">My Cost <span>(<?php echo trim($displayPackValue['Symbol']) ?>) <?php echo ($flexiPackageList['IsFixedDeparturePackage'] == 1) ? @$fromstrtotime : @$fromstrtotime . '-' . $tostrtotime; ?></span></th>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostDO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostFourO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostSixO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostEightO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostTenO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostTwelveO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostSO'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['AdultCostExtraBed'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostExtraBed'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostWithoutBed'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['CostInfent'] + '0' ?></td>
                                                                    <td bgcolor="#e7f9ef" class="text-center"><?php echo $displayPackValue['Tax'] ?></td>
                                                                </tr>
                                                                <tr class="<?php echo @$reseconomyid[$incPack] ?>_<?php echo @$fromstrtotime1 ?>_<?php echo @$tostrtotime1 ?>_<?php echo $MarketPlaceId ?>_<?php echo $PackCategoryId ?>">                                          
                                                                    <td colspan="2">
                                                                    <?php echo str_replace('MY', '', $arraykeyMarVal['MarketPlace']) ?> Sale Price <span>(<?php echo trim($arraykeyMarVal['Symbol']) ?>)</span>
                                                                    </td>
                                                                    <td nowrap><?php echo $arraykeyMarVal['MarkPercent'] + '0' ?> <?= $markuptype ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostPPDO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostFourO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostSixO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostEightO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostTenO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostTwelveO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostPPSO'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['AdultCostExtraBed'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostExtraBed'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostChildWithoutBed'] + '0' ?></td>
                                                                    <td class="text-center"><?php echo $arraykeyMarVal['CostInfent'] + '0' ?></td>
                                                                    <td>
                                                                        <a onclick="if (confirm('Are you sure! You want to delete.')) {
                                                                                    deletepackrate('<?php echo @$reseconomyid[$incPack] ?>', '<?php echo @$fromstrtotime1 ?>', '<?php echo @$tostrtotime1 ?>', '<?php echo $MarketPlaceId ?>', '<?php echo $PackCategoryId ?>');
                                                                                }" data-original-title="Delete" data-toggle="tooltip" data-placement="top" class="btn ls-red-btn btn-sm tooltipLink" href="javascript:void(0);"><i class="fa fa-trash-o"></i></a></td>
                                                                </tr>
                                                                <input type="hidden" id="rate_<?php echo $stdpacklist['EconomyMask']; ?>" value="1" />
                                                                <?php
                                                           }  $q++;  } }
                                                        } ?>

                                                    </table>
                                                </div>

                                            </div>
                                            <?php
                                        }
                                    }
                                    ?>                                    

                                </div>


                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="panel-body no-padding">
                            <div class="col-md-6">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <h3 class="panel-title">Settings</h3>
                                    </div>
                                    <div class="panel-body table-responsive no-padding">
                                        <table class="table table-bordered no-margin">
                                            <tbody>
<!--                                                <tr class="alert alert-info">
                                                    <th></th>
                                                    <th>Adult</th>                            
                                                </tr>-->
                                                <tr>
                                                    <td>Minimum Pax Allowed(Adult)</td>
                                                            <?php $nopaxArr = unserialize(CONST_MIN_NO_OF_PAX); ?>
                                                    <td><select onchange="return updateminpax('<?php echo @$flexiPackageList['TPSysId'] ?>', '1')" id="minpax" name="minpax" class="demo-default select-country" placeholder="Select">

                                                            <?php
                                                            foreach ($nopaxArr as $value) {
                                                                $minPaxSel = !empty($flexiPackageList['MinPax']) ? $flexiPackageList['MinPax'] : 2;
                                                                $selected = ($minPaxSel == $value) ? 'selected' : '';
                                                                echo "<option value='$value' $selected>$value</option>";
                                                            }
                                                            ?>
                                                        </select>
                                                    </td>                            
                                                </tr>
<?php //echo '<pre>'; print_r($flexiPackageList);     ?>
                                                <tr>
                                                    <td>Booking Validity
                                                    </td>
                                                    <td><input name="bookingvalidity"  id="bookingvalidity" type="text" class="form-control whbg readonly"  value="<?php echo @$flexiPackageList['PkgSellValidTill']->format('d/m/Y'); ?>">
                                                        <span class="unpublishLinkid" style="font-size: 9px; color:green;display:inline-block;">Package will appear in search till booking validity date.</span>
                                                    </td>                            
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>                
                            <div class="col-md-6">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <h3 class="panel-title">Booking Rules</h3>
                                    </div>
                                    <div class="panel-body table-responsive no-padding">
                                        <table class="table table-bordered no-margin">
                                            <tbody>
                                                <tr>
                                                    <td>Advance</td>
                                                    <td><input onchange="if ($('#advancerule').val() == '') {
                                                                alert('Please enter advance booking rule value');
                                                            } else {
                                                                return updateminpax('<?php echo @$flexiPackageList['TPSysId'] ?>', '2');
                                                            }
                                                            ;" name="advancerule" id="advancerule" type="text" class="form-control whbg pull-left"  onkeypress="return isNumber(event);
                                                               " maxlength="3" style="width:85%;" value="<?php
                                                               if ($flexiPackageList['AdvBookingPercent'] > 0) {
                                                                   echo @$flexiPackageList['AdvBookingPercent'];
                                                               } else {
                                                                   echo '10';
                                                               }
                                                               ?>">
                                                        &nbsp;&nbsp;%</td>
                                                    <td>at the time of confirmation</td>
                                                </tr>
                                                <tr>
                                                    <td>Balance before</td>
                                                    <td><input onchange="if ($('#balancerule').val() == '') {
                                                                alert('Please enter Balance before (no of days) value');
                                                            } else {
                                                                return updateminpax('<?php echo @$flexiPackageList['TPSysId'] ?>', '3');
                                                            }" name="balancerule" id="balancerule" type="text" class="form-control whbg pull-left" style="width:85%;" onkeypress="return isNumber(event);" maxlength="3" value="<?php
                                                               if ($flexiPackageList['AdvBookingDays'] > 0) {
                                                                   echo @$flexiPackageList['AdvBookingDays'];
                                                               } else {
                                                                   echo '30';
                                                               }
                                                               ?>">
                                                        &nbsp;&nbsp;days</td>
                                                    <td>before the departure date</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body no-padding">
                            <!--                            <div class="col-md-6">
                                                            <div class="panel panel-primary">
                                                                <div class="panel-heading">
                                                                    <h3 class="panel-title">Discount</h3>
                                                                </div>
                                                                <div class="panel-body table-responsive no-padding">
                                                                    <table class="table table-bordered no-margin">
                                                                        <tbody>
                                                                            <tr>
                                                                                <td>
                                                                                    <select onchange="return updateminpax('<?php echo @$flexiPackageList['TPSysId'] ?>')" id="DiscountType" value = "<?php echo $flexiPackageList['DiscountVal']; ?>" name="DiscountType"  class="demo-default select-country" placeholder="Select" style="width:150px;">                        
                                                                                        <option value="1" <?php
                            if ($flexiPackageList['DiscountType'] == '1') {
                                echo 'selected';
                            }
                            ?>>Fixed Amount</option>
                                                                                        <option value="2" <?php
                            if ($flexiPackageList['DiscountType'] == '2') {
                                echo 'selected';
                            }
                            ?>>Fixed %</option>
                                                                                    </select>
                                                                                </td>
                                                                                <td><input onchange="return updateminpax('<?php echo @$flexiPackageList['TPSysId'] ?>')" name="DiscountVal" id="DiscountVal" type="text" class="form-control whbg pull-left" style="width:85%;" value="<?php
                            if ($flexiPackageList['DiscountVal'] > 0) {
                                echo @$flexiPackageList['DiscountVal'];
                            } else {
                                echo '0';
                            }
                            ?>">
                                                                                </td>                            
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                            -->



                            <div class="col-md-6">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <h3 class="panel-title">Price Range</h3>
                                    </div>
                                    <div class="panel-body table-responsive no-padding">
                                        <table class="table table-bordered no-margin">
                                            <tbody>
                                                <tr>
                                                    <td><input name="pricerange" onchange="updatepricerange('<?php echo @$flexiPackageList['TPSysId'] ?>')" id="pricerange" type="text" value = "<?php echo @$flexiPackageList['PriceRange']; ?>" class="form-control whbg pull-left" style="width:85%;" value="">
                                                    </td>                            
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="panel-body whbg">
                            <div class="col-md-12 no-padding">
                                <div class="panel panel-danger">
                                    <div class="panel-heading">
                                        <h3 class="panel-title">Cancellation Rules</h3>
                                    </div>
                                    <div class="panel-body table-responsive no-padding">
                                        <table class="table table-bordered no-margin" name="cancellationres" id="cancellationres">
                                            <tbody>
                                                <tr>
                                                    <td>Before <?php $cancellation = array_reverse(unserialize(CONST_PACKAGE_CANCELLATION)); ?>
                                                        <select class="demo-default" placeholder="Select" name="cancel" id="cancel">
                                                            <?php
                                                            foreach ($cancellation as $value) {
                                                                echo "<option value='$value'>$value</option>";
                                                            }
                                                            ?>
                                                        </select>
                                                        Days</td>
                                                    <td><input type="text" class="form-control whbg pull-left" style="width:50px;" name="cancelpercnt" id="cancelpercnt" maxlength="3" onkeypress="return isNumber(event);">
                                                        <span class="pull-left">&nbsp;%&nbsp;&nbsp;+&nbsp;&nbsp;</span>
                                                        <input class="form-control whbg pull-left" style="width:70px;" type="text" name="cancelAmount" id="cancelAmount" onkeypress="return isNumber(event);">
                                                        &nbsp;<span class="currency"><?php echo $baseCurrencySymbol; ?></span></td>
                                                    <td><a href="javascript:void(0);" class="btn btn-success btn-sm tooltipLink"  data-placement="top" data-toggle="tooltip" data-original-title="Add" onclick="cancelpolicy()"><i class="fa fa-fw fa-arrows"></i></a></td>
                                                </tr>
                                                <?php
                                                if (count($packageCancelPolicyList) > 0) {
                                                    foreach ($packageCancelPolicyList as $cancelPolicy) {
                                                        echo "<tr id = 'ruleid_$cancelPolicy[TPRulesSysId]'>"
                                                        . "<td>$cancelPolicy[Title]</td>"
                                                        . "<td>$cancelPolicy[Value]% + <span class='currency'>$baseCurrencySymbol</span> $cancelPolicy[ExtraValue]</td>"
                                                        . "<td><a href='#' class='btn ls-red-btn btn-sm tooltipLink' onclick='deleteCancellation($cancelPolicy[DaysBefore],$cancelPolicy[TPRulesSysId]);'  data-placement='top' data-toggle='tooltip' data-original-title='Delete'>"
                                                        . "<i class='fa fa-trash-o'></i>"
                                                        . "</a></td>"
                                                        . "</tr>";
                                                    }
                                                }
                                                ?>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="col-md-12 no-padding no-margin">
                    <div class="panel-footer text-left" style="font-size: 10px;">
                        * Save : Will allow you to save the package details but it won't be available for search and share with customer sections.<br>
                        **Publish : Make the package Active for Searching and Sharing with customers. <br>
                        <span class="unpublishLinkid" style="color:green;<?php
                        if ($flexiPackageList['IsActive'] == 0) {
                            echo 'display:none;';
                        } else {
                            echo 'display:inline-block;';
                        }
                        ?>">*** This package is published.</span>
                        <span class="publishLinkid" style="color:red;<?php
                        if ($flexiPackageList['IsActive'] == 1) {
                            echo 'display:none;';
                        } else {
                            echo 'display:inline-block;';
                        }
                        ?>">*** This package is unpublished.</span>
                    </div>
                    <div class="panel-footer text-right">

                        <label  id="IsGTXNetworkChk" <?php if ($IsB2BRates == 0) { ?> style="display:none;" <?php } else { ?> style="display:;" <?php } ?>>
                            <input class="icheck-black" type="checkbox" <?php echo (!empty($flexiPackageList['IsGTXNetwork']) && $flexiPackageList['IsGTXNetwork'] == 1) ? 'checked="checked" disabled="disabled"' : '' ?> name="network" id="is_network" value="1">
                            &nbsp;GTX Network 
                        </label>

                        &nbsp;
<?php if ($this->IsB2CSite == 1) { ?>
                            <label>
                                <input class="icheck-black" type="checkbox" <?php echo (!empty($flexiPackageList['IsWebsite']) && $flexiPackageList['IsWebsite'] == 1) ? 'checked="checked" disabled="disabled"' : '' ?> name="website" id="is_website" value="1">
                                &nbsp;Website 
                            </label>
<?php } ?>
                        &nbsp;





                        <a href="<?php echo $this->baseUrl('package'); ?>" class="btn btn-primarygray btn-sm" >View Listing</a>
                        <a href="javascript:void(0)" class="btn btn-primarygray btn-sm"  data-target="#myModa1Modify" data-toggle="modal"><i class="fa fa-image"></i> View Package</a>
                        <a href="javascript:void(0)" class="btn btn-primarygray btn-sm pleaseWaitPublish" onclick="if (confirm('Are you sure, you want to save & continue this package.')) {
                                    openCategoryPopup('S', '<?php echo @$flexiPackageList['TPSysId'] ?>', '0');
                                }"><i class="fa fa-image"></i> Save As Draft</a>
                        <?php //if($flexiPackageList['IsActive'] == 0){  ?>
                        <a href="javascript:void(0)" id="publishLinkid" style="<?php
                        if ($flexiPackageList['IsActive'] == 1) {
                            echo 'display:none;';
                        } else {
                            echo 'display:inline-block;';
                        }
                        ?>" class="btn btn-warning btn-sm pleaseWaitPublish" onclick="if (confirm('Are you sure, you want to publish this package.')) {
                                       openCategoryPopup('P', '<?php echo @$flexiPackageList['TPSysId'] ?>', '1');
                                   }">Save & Publish</a>
                        <?php //} else {   ?>
                        <a href="javascript:void(0)" id="unpublishLinkid" style="<?php
                        if ($flexiPackageList['IsActive'] == 0) {
                            echo 'display:none;';
                        } else {
                            echo 'display:inline-block;';
                        }
                        ?>" class="btn btn-warning btn-sm pleaseWaitPublish" onclick="if (confirm('Are you sure, you want to unpublish this package.')) {
                                       openCategoryPopup('U', '<?php echo @$flexiPackageList['TPSysId'] ?>', '0');
                                   }">Unpublish</a>
<?php //}     ?>
                        <img class="loaderimg lazy" id="loaderimg"  data-src="<?php echo $this->baseUrl('public/images/load1.gif'); ?>" style="display: none;"/>

                    </div>
                </div>
            </div>
            <!-- Main Content Element  End-->
        </div>
    </div>
<?php echo $this->render('copyrightfooter.phtml'); ?>
</section>
<!--Page main section end -->
<!--Right hidden  section start-->
<?php echo $this->render('newfooter.phtml'); ?>

<script src="<?php echo $this->baseUrl('public/assets/js/tabulous.js'); ?>"></script>
<!-- MiniColors Library Script Start -->
<script src="<?php echo $this->baseUrl('public/assets/js/jquery.minicolors.min.js'); ?>"></script>
<!-- MiniColors Library Script Start -->

<!--Demo for Date, Time Color Picker Script Start -->
<script src="<?php echo $this->baseUrl('public/assets/js/pages/pickerTool.js'); ?>"></script>
<!--Demo for Date, Time Color Picker Script End -->
<script src="<?php echo $this->baseUrl('public/assets/js/summernote.min.js'); ?>"></script>
<script src="<?php echo $this->baseUrl('public/assets/js/pages/editor.js'); ?>"></script>
<!-- Script For Icheck -->
<script src="<?php echo $this->baseUrl('public/assets/js/icheck.min.js'); ?>"></script>
<!-- Script For Icheck -->
<script src="<?php echo $this->baseUrl('public/assets/js/pages/checkboxRadio.js'); ?>"></script>
<!--<script src="<?php // echo $this->baseUrl('public/assets/js/pages/uiElements.js');  ?>"></script>-->
<!--Demo ui element Script End -->
<?php
echo "<script>"
 . "function resetCostsheetAllPkg(){";
foreach ($reslastint as $tpSysId) {
    echo "resetCostsheet('$tpSysId');";
}
echo "}"
 . "</script>";
?>
<?php
echo "<script>"
 . "function getcurrencyexchangerateAllPkg(){";
foreach ($reslastint as $tpSysId) {
    echo "getcurrencyexchangerate('$tpSysId',0);";
}
echo "}"
 . "</script>";
?>

<script>




                               function openCategoryPopup(type, packageid, check) {
                                   var multipackres = $("#multipackres").val();
                                   if (check == 1) {
                                       $('#is_network').iCheck('enable');
                                       $('#is_website').iCheck('enable');
                                       var pkgCount = '<?php echo count($reseconomyid); ?>';
                                       var is_network = ($('#is_network').is(":checked")) ? 1 : 0;
                                       var is_website = ($('#is_website').is(":checked")) ? 1 : 0;
                                       //alert(is_website)
                                       var rate_1 = $('#rate_1').val();
                                       var rate_2 = $('#rate_2').val();
                                       var rate_3 = $('#rate_3').val();
                                       var rate = 0;
                                       if (rate_1 == 1) {
                                           rate = rate + 1;
                                       }
                                       if (rate_2 == 1) {
                                           rate = rate + 1;
                                       }
                                       if (rate_3 == 1) {
                                           rate = rate + 1;
                                       }
                                       var rateExist = rate;
                                       //console.log(pkgCount);
                                       //console.log(rateExist);
                                       if (parseInt(rateExist) !== parseInt(pkgCount)) {
                                           alert('Please enter rates in all selected categories.');
                                           $('#currency').focus();
                                           return false;
                                       }
//              alert(rateExist+'  '+pkgCount);
                                   }
                                   else {
                                       $('#is_network').iCheck('enable');
                                       $('#is_website').iCheck('enable');
                                       var is_network = ($('#is_network').is(":checked")) ? 1 : 0;
                                       var is_website = ($('#is_website').is(":checked")) ? 1 : 0;
                                   }
                                   //$('#myEditModal').removeData('bs.modal');
                                   $.ajax({
                                       url: '/package/update-status',
                                       data: {packageid: packageid, check: check, type: type, multipackres: multipackres, network: is_network, website: is_website},
                                       dataType: 'html',
                                       type: 'POST',
                                       beforeSend: function () {
                                           $('#loaderimg').css('display', 'inline-block');
                                           $('.pleaseWaitPublish').attr('disabled', true);
                                       },
                                       success: function (response) {

                                           if (response == 1) {
                                               alert('Package is published.');
                                               $('#unpublishLinkid, .unpublishLinkid').css('display', 'inline-block');
                                               $('#publishLinkid, .publishLinkid').css('display', 'none');
                                               //$('#is_network').attr("disabled",true);
                                               $('#is_network').iCheck('disable');
                                               $('#is_website').iCheck('disable');
                                           } else if (response == 0) {
                                               if (type == 'U') {
                                                   alert('Package is unpublished.');
                                                   $('#is_network').iCheck('enable');
                                                   $('#is_website').iCheck('enable');
                                                   $('#is_network').iCheck('uncheck');
                                                   $('#is_website').iCheck('uncheck');
                                               } else {
                                                   alert('Package is saved as draft.');
                                               }

                                               $('#unpublishLinkid, .unpublishLinkid').css('display', 'none');
                                               $('#publishLinkid, .publishLinkid').css('display', 'inline-block');
                                           } else {
                                               alert('There has been error, Please try again later.');
                                           }
                                           $('#loaderimg').css('display', 'none');
                                           $('.pleaseWaitPublish').removeAttr('disabled', true);

                                       }
                                   });
                               }

                               function showDays(firstDate, secondDate) {
                                   var startDay = new Date(firstDate);
                                   var endDay = new Date(secondDate);
                                   var millisecondsPerDay = 1000 * 60 * 60 * 24;

                                   var millisBetween = startDay.getTime() - endDay.getTime();
                                   var days = millisBetween / millisecondsPerDay;

                                   // Round down.
                                   alert(Math.floor(days));

                               }


                               $(document).ready(function () {
//            $('.datePickerOnly').click(function() {
//            var rateDateId = $(this).attr('id');
//            var arr = rateDateId.split('_');
//            if(arr[0] == 'from'){
//                var FromDateID = rateDateId;
//                var ToDateID = 'to_'+arr[1]+'_'+arr[2];
//            } else {
//                var FromDateID = 'from_'+arr[1]+'_'+arr[2];
//                var ToDateID = rateDateId;
//                
//            }
////            alert(FromDateID);alert(ToDateID);
//            var FromDate = $('#'+FromDateID).val();
//            var ToDate = $('#'+ToDateID).val();
//
//            });

                                   $('.datePickerOnly, #bookingvalidity').attr('readonly', true);
//        $(".datePickerOnly").datetimepicker({ 
//            scrollMonth : false,
//            scrollInput : false,
//            showOn: 'both' ,
//            minDate: 0,
//            format: 'm/d/Y',
//            onSelectDate: function(){
////                  alert($(this).attr('id'));
//
//                },
//            onChangeDateTime: function() { 
////                alert($(this).attr('id'));
//            }
//        });

                               });


                               $(".flightInfo").hover(function () {
                                   $(this).parent().children(".tooltipflight").show();
                               });

                               $(".flightInfo").mouseleave(function () {
                                   $(".tooltipflight").hide();
                               });

                               $(".btwob").click(function () {
                                   $("#b2br").show();
                               });

                               $(".tacid").click(function () {
                                   $("#b2br1").show();
                                   $("#b2br2").show();
                               });
                               function updatepricerange(tpID) {
                                   var pricerange = $("#pricerange").val();
                                   var multipackres = $("#multipackres").val();
                                   $.post("/package/updatepricerange", {pricerange: pricerange, tpID: tpID, multipackres: multipackres}, function () {
                                       // alert(data);
                                   });

                               }
                               function updateminpax(packid, type) {
                                   var minpax = $("#minpax").val();
                                   var multipackres = $("#multipackres").val();
                                   var advancerule = $("#advancerule").val();
                                   var balancerule = $("#balancerule").val();
                                   if (type == 2) {
                                       validatePercentVal('advancerule');
                                   }
//            var DiscountType        =   $("#DiscountType").val();            
//            var DiscountVal         =   $("#DiscountVal").val();
//            if(DiscountVal == ''){
//                DiscountVal = 0;
//            }
                                   $.ajax({
                                       url: '/package/update-package-minpax',
                                       data: {packid: packid, minpax: minpax, multipackres: multipackres, advancerule: advancerule, balancerule: balancerule, type: type}, //, DiscountType : DiscountType, DiscountVal : DiscountVal },
                                       dataType: 'html',
                                       type: 'POST',
                                       error: function () {
                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {

                                       }
                                   });
                               }
                               function deletepackrate(packid, fromdate, todate, MarketPlaceId, PackCategoryId, index) {
                                   var multipackres = $("#multipackres").val();
                                   $.ajax({
                                       url: '/package/delete-pack-rate',
                                       data: {packid: packid, fromdate: fromdate, todate: todate, multipackres: multipackres, MarketPlaceId: MarketPlaceId, PackCategoryId: PackCategoryId, index: index},
                                       dataType: 'json',
                                       type: 'POST',
                                       error: function () {
                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {

                                           if (response.success) {
                                               $("." + packid + "_" + fromdate + "_" + todate + "_" + MarketPlaceId + "_" + PackCategoryId).hide();
                                               if (response.rateRowCount == '0') {

                                                   $('#is_network').iCheck('enable');
                                                   $('#is_network').iCheck('uncheck');
                                                   $("#IsGTXNetworkChk").hide();
                                               }
                                           }


                                       }
                                   });
                               }
                               $(".copypaste").keyup(function () {
                                   var val = $(this).val();
                                   val = !isEmpty(val) ? val : '0';
                                   if (val !== '0') {
                                       var index = $(this).attr('index');
                                       var ind = index.split('_');
                                       for (var i = ind[0]; i <= 10; i++) {
                                           $('.pax_' + i + '_' + ind[1] + ind[2]).val(Math.round(val));
                                       }
                                   } else {
                                       var index = $(this).attr('index');
                                       var ind = index.split('_');
                                       for (var i = ind[0]; i <= 10; i++) {
                                           $('.pax_' + i + '_' + ind[1] + ind[2]).val('');
                                       }
                                   }

                               });

                               function updatepackrate(packid, index, type) {
                                   var packrate = $("#" + type + "_" + packid + '_' + index).val();

                                   getcurrencyexchangerate(packid, index);
                                   //alert(exchangerate);
                                   return false;
                                   $.ajax({
                                       url: '/package/update-pack-rate',
                                       data: {packid: packid, type: type, packrate: packrate, index: index},
                                       dataType: 'html',
                                       type: 'POST',
                                       error: function () {
                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {
                                           // alert('Updated successfully');
                                           //$("#resultdayiten").append(response);
                                           //$("#markup-settings-grid-content").html(response);
                                           //$("#markup-table-loader").css("display","none");
                                       }
                                   });
                               }   //
                               function getcurrencyexchangerate(packid, index) {
                                   var fromcurrency = $("#currency").val();
                                   var tocurrency = '<?php echo $baseCurrencyId; ?>';

                                   if (fromcurrency === '') {
                                       alert("Please select currency");
                                       resetCostsheet(packid);
                                       return false;
                                   }
                                   var res = fromcurrency.split("_");
                                   fromcurrency = res[0];
                                   $(".currencyres").html(res[1]);
//                                alert(fromcurrency +'==tocurrency='+ tocurrency);
                                   $.ajax({
                                       url: '/package/currency-exchange-rate',
                                       data: {packid: packid, fromcurrency: fromcurrency, tocurrency: tocurrency},
                                       dataType: 'html',
                                       type: 'POST',
                                       error: function () {
                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {
                                           if (fromcurrency === tocurrency) {
                                               var multiplier = '1';
                                           } else {
                                               var multiplier = response;
                                           }
                                           var CostTwoPax = $("#CostTwoPax_" + packid + '_' + index).val();
                                           var CostFourPax = $("#CostFourPax_" + packid + '_' + index).val();
                                           var CostSixPax = $("#CostSixPax_" + packid + '_' + index).val();
                                           var CostEightPax = $("#CostEightPax_" + packid + '_' + index).val();
                                           var CostTenPax = $("#CostTenPax_" + packid + '_' + index).val();
                                           var CostTwelvePax = $("#CostTwelvePax_" + packid + '_' + index).val();

                                           var CostExtraSO = $("#CostExtraSO_" + packid + '_' + index).val();
                                           var CostPerAdultExtraBed = $("#CostPerAdultExtraBed_" + packid + '_' + index).val();
                                           var CostPerChildExtraBed = $("#CostPerChildExtraBed_" + packid + '_' + index).val();
                                           var CostPerChildWithExtraBed = $("#CostPerChildWithExtraBed_" + packid + '_' + index).val();
                                           var CostPerInfent = $("#CostPerInfent_" + packid + '_' + index).val();

                                           $("#NewCostTwoPax_" + packid + '_' + index).val(parseFloat(CostTwoPax * multiplier).toFixed(2));
                                           $("#NewCostFourPax_" + packid + '_' + index).val(parseFloat(CostFourPax * multiplier).toFixed(2));
                                           $("#NewCostSixPax_" + packid + '_' + index).val(parseFloat(CostSixPax * multiplier).toFixed(2));
                                           $("#NewCostEightPax_" + packid + '_' + index).val(parseFloat(CostEightPax * multiplier).toFixed(2));
                                           $("#NewCostTenPax_" + packid + '_' + index).val(parseFloat(CostTenPax * multiplier).toFixed(2));
                                           $("#NewCostTwelvePax_" + packid + '_' + index).val(parseFloat(CostTwelvePax * multiplier).toFixed(2));

                                           $("#NewCostExtraSO_" + packid + '_' + index).val(parseFloat(CostExtraSO * multiplier).toFixed(2));
                                           $("#NewCostPerAdultExtraBed_" + packid + '_' + index).val(parseFloat(CostPerAdultExtraBed * multiplier).toFixed(2));
                                           $("#NewCostPerChildExtraBed_" + packid + '_' + index).val(parseFloat(CostPerChildExtraBed * multiplier).toFixed(2));
                                           $("#NewCostPerChildWithExtraBed_" + packid + '_' + index).val(parseFloat(CostPerChildWithExtraBed * multiplier).toFixed(2));
                                           $("#NewCostPerInfent_" + packid + '_' + index).val(parseFloat(CostPerInfent * multiplier).toFixed(2));

                                           updatemarkup(packid, index, 'B2B');
                                           updatemarkup(packid, index, 'B2C');
                                       }
                                   });
                               }   //
                               function updatemarkup(packageId, index, MP) {

                                   $("#NewCostTwoPaxId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostFourPaxId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostSixPaxId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostEightPaxId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostTenPaxId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostTwelvePaxId_" + packageId + '_' + index + '_' + MP).val('');

                                   $("#NewCostExtraSOId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostPerChildExtraBedId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostPerChildWithExtraBedId_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#NewCostPerInfentId_" + packageId + '_' + index + '_' + MP).val('');


                                   $("#tax_" + packageId + '_' + index + '_' + MP).val('');
                                   $("#taxres_" + packageId + '_' + index + '_' + MP).val(0);

                                   var NewCostTwoPax = $("#NewCostTwoPax_" + packageId + '_' + index).val();
                                   var NewCostFourPax = $("#NewCostFourPax_" + packageId + '_' + index).val();
                                   var NewCostSixPax = $("#NewCostSixPax_" + packageId + '_' + index).val();
                                   var NewCostEightPax = $("#NewCostEightPax_" + packageId + '_' + index).val();
                                   var NewCostTenPax = $("#NewCostTenPax_" + packageId + '_' + index).val();
                                   var NewCostTwelvePax = $("#NewCostTwelvePax_" + packageId + '_' + index).val();

                                   var NewCostExtraSO = $("#NewCostExtraSO_" + packageId + '_' + index).val();
                                   var NewCostPerAdultExtraBed = $("#NewCostPerAdultExtraBed_" + packageId + '_' + index).val();
                                   var NewCostPerChildExtraBed = $("#NewCostPerChildExtraBed_" + packageId + '_' + index).val();
                                   var NewCostPerChildWithExtraBed = $("#NewCostPerChildWithExtraBed_" + packageId + '_' + index).val();
                                   var NewCostPerInfent = $("#NewCostPerInfent_" + packageId + '_' + index).val();

                                   var ComssnType = $("#ComssnType" + index).val();
                                   var markup = $("#markup_" + packageId + '_' + index + '_' + MP).val();
                                   if (markup === '') {
                                       markup = 0;
                                   }
//            alert(markup);

                                   if (ComssnType === 'FixedAmount') {
                                       var NewCostTwoPaxId = 0;
                                       var NewCostFourPaxId = 0;
                                       var NewCostSixPaxId = 0;
                                       var NewCostEightPaxId = 0;
                                       var NewCostTenPaxId = 0;
                                       var NewCostTwelvePaxId = 0;

                                       var NewCostExtraSOId = 0;
                                       var NewCostPerAdultExtraBedId = 0;
                                       var NewCostPerChildExtraBedId = 0;
                                       var NewCostPerChildWithExtraBedId = 0;
                                       var NewCostPerInfentId = 0;
//                if(markup!=''){
                                       if (NewCostTwoPax !== '' && NewCostTwoPax !== '0.00') {
                                           NewCostTwoPaxId = parseFloat(NewCostTwoPax) + parseFloat(markup);
                                       }
                                       if (NewCostFourPax !== '' && NewCostFourPax !== '0.00') {
                                           NewCostFourPaxId = parseFloat(NewCostFourPax) + parseFloat(markup);
                                       }
                                       if (NewCostSixPax !== '' && NewCostSixPax !== '0.00') {
                                           NewCostSixPaxId = parseFloat(NewCostSixPax) + parseFloat(markup);
                                       }
                                       if (NewCostEightPax !== '' && NewCostEightPax !== '0.00') {
                                           NewCostEightPaxId = parseFloat(NewCostEightPax) + parseFloat(markup);
                                       }
                                       if (NewCostTenPax !== '' && NewCostTenPax !== '0.00') {
                                           NewCostTenPaxId = parseFloat(NewCostTenPax) + parseFloat(markup);
                                       }
                                       if (NewCostTwelvePax !== '' && NewCostTwelvePax !== '0.00') {
                                           NewCostTwelvePaxId = parseFloat(NewCostTwelvePax) + parseFloat(markup);
                                       }

                                       if (NewCostExtraSO !== '' && NewCostExtraSO !== '0.00') {
                                           NewCostExtraSOId = parseFloat(NewCostExtraSO) + parseFloat(markup);
                                       }
                                       if (NewCostPerAdultExtraBed !== '' && NewCostPerAdultExtraBed !== '0.00') {
                                           NewCostPerAdultExtraBedId = parseFloat(NewCostPerAdultExtraBed) + parseFloat(markup);
                                       }
                                       if (NewCostPerChildExtraBed !== '' && NewCostPerChildExtraBed !== '0.00') {
                                           NewCostPerChildExtraBedId = parseFloat(NewCostPerChildExtraBed) + parseFloat(markup);
                                       }
                                       if (NewCostPerChildWithExtraBed !== '' && NewCostPerChildWithExtraBed !== '0.00') {
                                           NewCostPerChildWithExtraBedId = parseFloat(NewCostPerChildWithExtraBed) + parseFloat(markup);
                                       }
                                       if (NewCostPerInfent !== '' && NewCostPerInfent !== '0.00') {
                                           NewCostPerInfentId = parseFloat(NewCostPerInfent) + parseFloat(markup);
                                       }
//                                    alert(13.50 + 900);
                                       $("#NewCostTwoPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostTwoPaxId).toFixed(2));
                                       $("#NewCostFourPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostFourPaxId).toFixed(2));
                                       $("#NewCostSixPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostSixPaxId).toFixed(2));
                                       $("#NewCostEightPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostEightPaxId).toFixed(2));
                                       $("#NewCostTenPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostTenPaxId).toFixed(2));
                                       $("#NewCostTwelvePaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostTwelvePaxId).toFixed(2));

                                       $("#NewCostExtraSOId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostExtraSOId).toFixed(2));
                                       $("#NewCostPerAdultExtraBedId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerAdultExtraBedId).toFixed(2));
                                       $("#NewCostPerChildExtraBedId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerChildExtraBedId).toFixed(2));
                                       $("#NewCostPerChildWithExtraBedId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerChildWithExtraBedId).toFixed(2));
                                       $("#NewCostPerInfentId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerInfentId).toFixed(2));

                                   } else {
                                       validatePercentVal("markup_" + packageId + '_' + index + '_' + MP);  // validating %age markup between 0 to 100

                                       if (markup !== '') {
                                           var NewCostTwoPaxId_val = parseFloat(parseFloat(parseFloat(NewCostTwoPax) * parseFloat(markup) / 100) + parseFloat(NewCostTwoPax));
                                           var NewCostFourPaxId_val = parseFloat(parseFloat(parseFloat(NewCostFourPax) * parseFloat(markup) / 100) + parseFloat(NewCostFourPax));
                                           var NewCostSixPaxId_val = parseFloat(parseFloat(parseFloat(NewCostSixPax) * parseFloat(markup) / 100) + parseFloat(NewCostSixPax));
                                           var NewCostEightPaxId_val = parseFloat(parseFloat(parseFloat(NewCostEightPax) * parseFloat(markup) / 100) + parseFloat(NewCostEightPax));
                                           var NewCostTenPaxId_val = parseFloat(parseFloat(parseFloat(NewCostTenPax) * parseFloat(markup) / 100) + parseFloat(NewCostTenPax));
                                           var NewCostTwelvePaxId_val = parseFloat(parseFloat(parseFloat(NewCostTwelvePax) * parseFloat(markup) / 100) + parseFloat(NewCostTwelvePax));
                                           var NewCostExtraSOId_vals = parseFloat(parseFloat(parseFloat(NewCostExtraSO) * parseFloat(markup) / 100) + parseFloat(NewCostExtraSO));
                                           var NewCostPerAdultExtraBedId_vals = parseFloat(parseFloat(parseFloat(NewCostPerAdultExtraBed) * parseFloat(markup) / 100) + parseFloat(NewCostPerAdultExtraBed));
                                           var NewCostPerChildExtraBedId_vals = parseFloat(parseFloat(parseFloat(NewCostPerChildExtraBed) * parseFloat(markup) / 100) + parseFloat(NewCostPerChildExtraBed));
                                           var NewCostPerChildWithExtraBedId_vals = parseFloat(parseFloat(parseFloat(NewCostPerChildWithExtraBed) * parseFloat(markup) / 100) + parseFloat(NewCostPerChildWithExtraBed));
                                           var NewCostPerInfentId_vals = parseFloat(parseFloat(parseFloat(NewCostPerInfent) * parseFloat(markup) / 100) + parseFloat(NewCostPerInfent));


                                           $("#NewCostTwoPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostTwoPaxId_val).toFixed(2));
                                           $("#NewCostFourPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostFourPaxId_val).toFixed(2));
                                           $("#NewCostSixPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostSixPaxId_val).toFixed(2));
                                           $("#NewCostEightPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostEightPaxId_val).toFixed(2));
                                           $("#NewCostTenPaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostTenPaxId_val).toFixed(2));
                                           $("#NewCostTwelvePaxId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostTwelvePaxId_val).toFixed(2));
                                           $("#NewCostExtraSOId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostExtraSOId_vals).toFixed(2));
                                           $("#NewCostPerAdultExtraBedId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerAdultExtraBedId_vals).toFixed(2));
                                           $("#NewCostPerChildExtraBedId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerChildExtraBedId_vals).toFixed(2));
                                           $("#NewCostPerChildWithExtraBedId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerChildWithExtraBedId_vals).toFixed(2));
                                           $("#NewCostPerInfentId_" + packageId + '_' + index + '_' + MP).val(parseFloat(NewCostPerInfentId_vals).toFixed(2));
                                       }
//                                    console.log(NewCostExtraSO);
//                                    console.log(NewCostPerAdultExtraBed);
//                                    console.log(NewCostPerChildExtraBed);
//                                    console.log(NewCostPerChildWithExtraBed);
//                                    console.log(NewCostPerInfent);
                                   }

//                                var marketPlace = $("#marketPlace_" + packageId+'_'+index+'_'+MP).val();
//                                var permission = $("#permission_" + packageId+'_'+index+'_'+MP).val();
//                                
//                                var singleoccupancy = $("#NewCostTwoPaxId_" + packageId+'_'+index+'_'+MP).val();
//                                var doubleoccupancy = $("#doubleoccupancy_" + packageId+'_'+index+'_'+MP).val();
//                                var tripleoccupancy = $("#tripleoccupancy_" + packageId+'_'+index+'_'+MP).val();
//                                var extrabed = $("#extrabed_" + packageId+'_'+index+'_'+MP).val();
//                                var withoutbed = $("#withoutbed_" + packageId+'_'+index+'_'+MP).val();
//                                var taxtype = $("#taxtype_" + packageId+'_'+index+'_'+MP).val();
//                                var taxres = $("#taxres_" + packageId+'_'+index+'_'+MP).val();
//            alert(ComssnType);
//            alert(marketPlace);
//            alert(markup);
//            alert(singleoccupancy);
//            alert(doubleoccupancy);
//            alert(extrabed);
//            alert(withoutbed);
//            alert(tax);
//            alert(taxres);
                                   return false;
                               }

                               function marketplacerate(packageId, packType, index, MP) {
                                   var MarkType = $("#ComssnType" + index).val();
                                   var marketPlace = $("#marketPlace_" + packageId + '_' + index + '_' + MP).val();
                                   //console.log(marketPlace);
                                   var arrMarketId = marketPlace.split('_');
                                   var marketId = arrMarketId[0];
                                   var from_date = $("#from_date_" + packageId + '_' + index).val();
                                   var to_date = $("#to_date_" + packageId + '_' + index).val();
                                   var multipackres = $("#multipackres").val();
                                   var currency = $("#currency").val();
                                   var tocurrency = '<?php echo $baseCurrencyId; ?>';

                                   if (currency === '') {
                                       alert("Please select currency");
                                       $("#currency").focus();
                                       return false;
                                   }

                                   if ((from_date === '') || (from_date === '__/__/____')) {
                                       alert("Please enter from date");
                                       $("#from_date_" + packageId).focus();
                                       return false;
                                   }
                                   if ((to_date === '') || (to_date === '__/__/____')) {
                                       alert("Please enter to date");
                                       $("#to_date_" + packageId).focus();
                                       return false;
                                   }

                                   if (marketPlace === '') {
                                       alert("Please select Market Place Type");
                                       $("#marketPlace").focus();
                                       return false;
                                   }


                                   var from_date_str = from_date.split("/");
                                   var fromdate = from_date_str[2] + '-' + from_date_str[1] + '-' + from_date_str[0]; //Year, Month, Date
                                   var to_date_str = to_date.split("/");
                                   var todate = to_date_str[2] + '-' + to_date_str[1] + '-' + to_date_str[0];

                                   var permission = $("#permission_" + packageId + '_' + index + '_' + MP).val();
                                   var markup = $("#markup_" + packageId + '_' + index + '_' + MP).val();

                                   var NewCostTwoPaxId = $("#NewCostTwoPaxId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostFourPaxId = $("#NewCostFourPaxId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostSixPaxId = $("#NewCostSixPaxId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostEightPaxId = $("#NewCostEightPaxId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostTenPaxId = $("#NewCostTenPaxId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostTwelvePaxId = $("#NewCostTwelvePaxId_" + packageId + '_' + index + '_' + MP).val();



                                   var NewCostExtraSOId = $("#NewCostExtraSOId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostPerAdultExtraBedId = $("#NewCostPerAdultExtraBedId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostPerChildExtraBedId = $("#NewCostPerChildExtraBedId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostPerChildWithExtraBedId = $("#NewCostPerChildWithExtraBedId_" + packageId + '_' + index + '_' + MP).val();
                                   var NewCostPerInfentId = $("#NewCostPerInfentId_" + packageId + '_' + index + '_' + MP).val();

                                   var taxtype = $("#taxtype_" + packageId + '_' + index + '_' + MP).val();
                                   var taxres = $("#taxres_" + packageId + '_' + index + '_' + MP).val();

                                   var inventoryqty = $("#inventoryqty_" + packageId + '_' + index).val();

                                   var CostTwoPax = $("#CostTwoPax_" + packageId + '_' + index).val();
                                   var CostFourPax = $("#CostFourPax_" + packageId + '_' + index).val();
                                   var CostSixPax = $("#CostSixPax_" + packageId + '_' + index).val();
                                   var CostEightPax = $("#CostEightPax_" + packageId + '_' + index).val();
                                   var CostTenPax = $("#CostTenPax_" + packageId + '_' + index).val();
                                   var CostTwelvePax = $("#CostTwelvePax_" + packageId + '_' + index).val();

                                   var CostExtraSO = $("#CostExtraSO_" + packageId + '_' + index).val();
                                   var CostPerAdultExtraBed = $("#CostPerAdultExtraBed_" + packageId + '_' + index).val();
                                   var CostPerChildExtraBed = $("#CostPerChildExtraBed_" + packageId + '_' + index).val();
                                   var CostPerChildWithExtraBed = $("#CostPerChildWithExtraBed_" + packageId + '_' + index).val();
                                   var CostPerInfent = $("#CostPerInfent_" + packageId + '_' + index).val();

                                   var NewCostTwoPax = $("#NewCostTwoPax_" + packageId + '_' + index).val();
                                   var NewCostFourPax = $("#NewCostFourPax_" + packageId + '_' + index).val();
                                   var NewCostSixPax = $("#NewCostSixPax_" + packageId + '_' + index).val();
                                   var NewCostEightPax = $("#NewCostEightPax_" + packageId + '_' + index).val();
                                   var NewCostTenPax = $("#NewCostTenPax_" + packageId + '_' + index).val();

                                   var NewCostTwelvePax = $("#NewCostTwelvePax_" + packageId + '_' + index).val();


                                   var NewCostExtraSO = $("#NewCostExtraSO_" + packageId + '_' + index).val();
                                   var NewCostPerAdultExtraBed = $("#NewCostPerAdultExtraBed_" + packageId + '_' + index).val();
                                   var NewCostPerChildExtraBed = $("#NewCostPerChildExtraBed_" + packageId + '_' + index).val();
                                   var NewCostPerChildWithExtraBed = $("#NewCostPerChildWithExtraBed_" + packageId + '_' + index).val();
                                   var NewCostPerInfent = $("#NewCostPerInfent_" + packageId + '_' + index).val();
                                   var isFixedDep = '<?php echo $flexiPackageList['IsFixedDeparturePackage']; ?>';

                                   var validatecount = '0';
                                   if (fromdate > todate) {
                                       alert("Please select to date greater than from date");
                                       return false;
                                   }
                                   if (CostTwoPax !== '') {
                                       validatecount = parseInt(validatecount) + parseInt(1);
                                   }
                                   if (CostFourPax !== '') {
                                       validatecount = parseInt(validatecount) + parseInt(1);
                                   }
                                   if (CostSixPax !== '') {
                                       validatecount = parseInt(validatecount) + parseInt(1);
                                   }
                                   if (validatecount < 1) {
                                       alert("Please enter atleast one of the below rates - Single Occupancy");
                                       return false;
                                   }
                                   if (markup === '') {
                                       alert("Please enter mark up");
                                       $("#markup_" + packageId).focus();
                                       return false;
                                   }
                                   if (taxtype === '') {
                                       alert("Please select tax");
                                       $("#taxtype_" + packageId).focus();
                                       return false;
                                   }
//            if(taxtype!='Included') { 
//                if(taxres=='') {
//                  alert("Please enter tax");
//                  $("#taxres_"+packageId).focus();
//                  return false;
//                }
//            }   
                                   if (permission === '1') {
                                       var perm = 'Allow';
                                   } else {
                                       var perm = 'Not-Allowed';
                                   }
                                   //return false;
                                   //var htmlres             =   '<tr><td>'+fromdate+' - '+todate+'</td><td>'+perm+'</td><td>'+markup+'</td><td class="text-center">'+singleoccupancy+'</td><td class="text-center">'+doubleoccupancy+'</td><td class="text-center">'+extrabed+'</td>  <td class="text-center">'+withoutbed+'</td><td class="text-center">'+taxtype+' '+taxres+'</td><td><a href="javascript:void(0);" class="btn ls-red-btn btn-sm tooltipLink"  data-placement="top" data-toggle="tooltip" data-original-title="Delete"><i class="fa fa-trash-o"></i></a></td></tr>';
                                   // $("#costmarkupres_"+packageId).append(htmlres);
                                   //alert(inventoryqty);
                                   //return false;
                                   $.ajax({
                                       url: '/package/package-marketwise-rate',
                                       data: {fromdate: fromdate, todate: todate, ratecurrency: currency, currency: tocurrency, packageId: packageId, MarkType: MarkType, marketPlace: marketPlace, permission: permission, markup: markup, CostTwoPax: CostTwoPax, CostFourPax: CostFourPax, CostSixPax: CostSixPax, CostEightPax: CostEightPax, CostTenPax: CostTenPax, CostTwelvePax: CostTwelvePax, CostExtraSO: CostExtraSO, CostPerAdultExtraBed: CostPerAdultExtraBed, CostPerChildExtraBed: CostPerChildExtraBed, CostPerChildWithExtraBed: CostPerChildWithExtraBed, CostPerInfent: CostPerInfent, tax: taxtype, taxres: taxres, NewCostTwoPax: NewCostTwoPax, NewCostFourPax: NewCostFourPax, NewCostSixPax: NewCostSixPax, NewCostEightPax: NewCostEightPax, NewCostTenPax: NewCostTenPax, NewCostTwelvePax: NewCostTwelvePax, NewCostExtraSO: NewCostExtraSO, NewCostPerAdultExtraBed: NewCostPerAdultExtraBed, NewCostPerChildExtraBed: NewCostPerChildExtraBed, NewCostPerChildWithExtraBed: NewCostPerChildWithExtraBed, NewCostPerInfent: NewCostPerInfent, multipackres: multipackres, packType: packType, NewCostTwoPaxId: NewCostTwoPaxId, NewCostFourPaxId: NewCostFourPaxId, NewCostSixPaxId: NewCostSixPaxId, NewCostEightPaxId: NewCostEightPaxId, NewCostTenPaxId: NewCostTenPaxId, NewCostTwelvePaxId: NewCostTwelvePaxId, NewCostExtraSOId: NewCostExtraSOId, NewCostPerAdultExtraBedId: NewCostPerAdultExtraBedId, NewCostPerChildExtraBedId: NewCostPerChildExtraBedId, NewCostPerChildWithExtraBedId: NewCostPerChildWithExtraBedId, NewCostPerInfentId: NewCostPerInfentId, index: index, inventoryqty: inventoryqty, isFixedDep: isFixedDep},
                                       dataType: 'html',
                                       type: 'POST',
                                       error: function () {

                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {
                                           if (response === '2') {
                                               alert('Package Rates are already created between these dates and same market place type . Please choose another option and try again.');
                                           } else {
                                               $('#' + MP + '_' + packageId + '_' + packType + '_' + index).hide();
                                               $("#costmarkupres_" + packageId + '_' + index).append(response);
                                               $("#viewcostmarkupres_" + packageId).append(response);

                                               if ($.trim(marketId) === "2") {
                                                   $("#IsGTXNetworkChk").show();
                                               }
                                           }
                                           //resetCostsheet(packageId);
                                       }


                                   });

                               }
                               function updateopinclmarkup(packageId, actId, day, cost) {

                                   var markup = $("#markup_" + packageId + "_" + actId + "_" + day).val();
                                   // alert(markup);
                                   // alert(cost);
                                   var inccost = (cost * markup) / 100;
                                   var newcost = parseFloat(inccost).toFixed(2) + parseFloat(cost).toFixed(2);
                                   $("#markres_" + packageId + "_" + actId + "_" + day).html(newcost);
                                   //alert(detail);markres_
                                   $.ajax({
                                       url: '/package/update-optional-incl-markup',
                                       data: {packageId: packageId, actId: actId, day: day, markup: markup},
                                       dataType: 'html',
                                       type: 'POST',
                                       error: function () {

                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {
                                           // alert('Updated successfully');
                                           //$("#resultdayiten").append(response);
                                           //$("#markup-settings-grid-content").html(response);
                                           //$("#markup-table-loader").css("display","none");
                                       }
                                   });
                               }

                               function validatePercentVal(input) {
                                   var Val = parseInt($('#' + input).val());
                                   if (Val < 0 || Val > 100)
                                       alert("Value should be between 0 - 100");
                                   if (Val < 0)
                                       $('#' + input).val('0');
                                   if (Val > 100)
                                       $('#' + input).val('100');
                                   return;
                               }
                               function handleChange(input) {
                                   if (input.value < 0)
                                       input.value = 0;
                                   if (input.value > 100)
                                       input.value = 100;
                               }
                               document.getElementById("cancelpercnt").onkeyup = function () {
                                   var input = parseInt(this.value);
                                   if (input < 0 || input > 100)
                                       alert("Value should be between 0 - 100");
                                   handleChange(this);
                                   return;
                               }

                               function deleteCancellation(cancelval, id) {
                                   var multipackres = $("#multipackres").val();
                                   if (confirm('Are you sure, you want to delete this rule.')) {
                                       $.ajax({
                                           url: '/package/delete-cancellation-policy',
                                           data: {cancelval: cancelval, multipackres: multipackres},
                                           dataType: 'html',
                                           type: 'POST',
                                           error: function () {
                                           },
                                           beforeSend: function () {
                                           },
                                           success: function (response) {
                                               if (response == 1) {
                                                   $('#ruleid_' + id).html('');
                                                   alert('Rule is deleted successfully');
                                                   window.location.hash = '#cancellationres';
                                               } else {
                                                   alert('Oops! something went wrong. Please try after sometime.');
                                               }
                                           }
                                       });
                                   }

                               }
                               function cancelpolicy() {
                                   var cancel = $("#cancel").val();
                                   var cancelpercnt = $("#cancelpercnt").val();
                                   var cancelAmount = $("#cancelAmount").val();
                                   var packageId = $("#packageId").val();
                                   var multipackres = $("#multipackres").val();
                                   if (cancelpercnt == '' && cancelAmount == '') {
                                       alert('Please enter value in any one i.e. Percent or Amount');
                                       return false;
                                   }


                                   $.ajax({
                                       url: '/package/package-cancel-policy',
                                       data: {packageId: packageId, cancel: cancel, cancelpercnt: cancelpercnt, cancelAmount: cancelAmount, multipackres: multipackres},
                                       dataType: 'json',
                                       type: 'POST',
                                       error: function () {

                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {
                                           if (response.success == 1) {
                                               $("#cancellationres").append(response.msg);
                                           } else {
                                               alert(response.msg);
                                           }
//                 var htmlres  = '<tr><td>Before '+cancel+' Days</td><td>'+cancelpercnt+'%  + <span class="fa fa-inr"></span> '+cancelAmount+'</td><td><a href="#" class="btn ls-red-btn btn-sm tooltipLink"  data-placement="top" data-toggle="tooltip" data-original-title="Delete"><i class="fa fa-trash-o"></i></a></td></tr>';    

                                           // alert('Updated successfully');
                                           //$("#resultdayiten").append(response);
                                           //$("#markup-settings-grid-content").html(response);
                                           //$("#markup-table-loader").css("display","none");
                                       }
                                   });

                               }
                               var totcost = '0';
                               $(".calccost").each(function () {
                                   totcost = parseFloat(totcost).toFixed(2) + parseFloat($(this).val()).toFixed(2);
                               });
                               //alert(totcost);
                               $(".costresult").html(totcost);
                               function updatepackagecost() {
                                   var cost = $(".costresult").html();
                                   var packageId = $("#packageId").val();
                                   //alert(cost);
                                   $.ajax({
                                       url: '/package/update-package-cost',
                                       data: {packageId: packageId, cost: cost},
                                       dataType: 'html',
                                       type: 'POST',
                                       error: function () {

                                       },
                                       beforeSend: function () {
                                           // $("#markup-table-loader").css("display","inline-block");
                                           // $("#markup-settings-grid-content").html('');
                                       },
                                       success: function (response) {
                                           // alert('Updated successfully');
                                           //$("#resultdayiten").append(response);
                                           //$("#markup-settings-grid-content").html(response);
                                           //$("#markup-table-loader").css("display","none");
                                       }
                                   });
                               }
                               updatepackagecost();
                               updateminpax('<?php echo @$flexiPackageList['TPSysId'] ?>');

//$(document).ready(function(){
                               $('#bookingvalidity').datetimepicker({
                                   scrollMonth: false,
                                   scrollInput: false,
                                   timepicker: false,
                                   minDate: 0,
                                   format: 'd/m/Y',
                                   onChangeDateTime: function (dateText, inst) {
//        var date = $('#bookingvalidity').val();
//        alert(date);
                                       updatepackagevalidity();
                                   }
                               });
//});

                               function updatepackagevalidity() {
                                   var packageId = $("#packageId").val();
                                   var date = $("#bookingvalidity").val();
                                   var multipackres = $("#multipackres").val();
                                   $.post("/package/updatepackagevalidity", {packageId: packageId, date: date, multipackres: multipackres}, function (response) {
                                       //console.log(response);
                                   });

                               }

                               function isNumber(evt) {
                                   evt = (evt) ? evt : window.event;
                                   var charCode = (evt.which) ? evt.which : evt.keyCode;
                                   if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                                       return false;
                                   }
                                   return true;
                               }
                               function resetCostsheet(packid) {
                                   $('#from_date_' + packid).val('__/__/____');
                                   $('#to_date_' + packid).val('__/__/____');
                                   $('#CostTO_' + packid).val('');
                                   $('#CostDO_' + packid).val('');
                                   $('#CostSO_' + packid).val('');
                                   $('#CostExtraBed_' + packid).val('');
                                   $('#CostWithoutBed_' + packid).val('');
                                   $('#NewCostTO_' + packid).val('');
                                   $('#NewCostDO_' + packid).val('');
                                   $('#NewCostSO_' + packid).val('');
                                   $('#NewCostExtraBed_' + packid).val('');
                                   $('#NewCostWithoutBed_' + packid).val('');
                                   $('#markup_' + packid).val('');
                                   $('#tripleoccupancy_' + packid).val('');
                                   $('#doubleoccupancy_' + packid).val('');
                                   $('#singleoccupancy_' + packid).val('');
                                   $('#extrabed_' + packid).val('');
                                   $('#withoutbed_' + packid).val('');
                                   $('#taxres_' + packid).val(0);
                               }

                               function taxRes(packageId) {
                                   var taxtype = $("#taxtype_" + packageId).val();
                                   var display = (taxtype === 'Included') ? 'none' : 'inline-block';
                                   $('#taxres_' + packageId).css('display', display);
                               }
                               function clickaccordion(accdnid, index) {
                                   var accdval = $("#accdnid_" + accdnid + '_' + index).val();
//                                                                            alert(accdval);
                                   if (accdval == 'active') {
                                       $("#accdresid_" + accdnid + '_' + index).show();
                                       $("#accdnid_" + accdnid + '_' + index).val('minuscl');
                                       $("#a_" + accdnid + '_' + index).removeClass('active');
                                       $("#i_" + accdnid + '_' + index).addClass('fa-angle-up large').removeClass('fa-angle-down large');
                                   } else {
                                       $("#accdresid_" + accdnid + '_' + index).hide();
                                       $("#accdnid_" + accdnid + '_' + index).val('active');
                                       $("#a_" + accdnid + '_' + index).addClass('active');
                                       $("#i_" + accdnid + '_' + index).addClass('fa-angle-down large').removeClass('fa-angle-up large');
                                   }
                               }




                               $('#search_add_rates').on('submit', function () {
                                   var from_date = $('#search_add_rates input[name="from_date[]"]');
                                   var to_date = $('#search_add_rates input[name="to_date[]"]');
                                   var b2b = $('#search_add_rates input[name="b2b[]"]');
                                   var b2c = $('#search_add_rates input[name="b2c[]"]');
                                   var inventory = $('#search_add_rates input[name="inventory[]"]');
                                   for (i = 0; i < from_date.length; i++) {
//        var d1 = from_date[i].value.trim().split('/');
//        var d2 = to_date[i].value.trim().split('/');
//        var dt1 = d1[2]+''+d1[1]+''+d1[0];
//        var dt2 = d2[2]+''+d2[1]+''+d2[0];
//        
//        console.log(dt1);
//        console.log(dt2);
//        if(d1 === d2){
//            alert('Date range should be different');
//            return false;
//        }
                                       if (from_date[i].value.trim() === "" || from_date[i].value.trim() === "__/__/____") {
                                           alert('Please enter from date');
                                           //from_date[i].focus();
                                           return false;
                                       }
                                       if (to_date[i].value.trim() === "" || to_date[i].value.trim() === "__/__/____") {
                                           alert('Please enter to date');
                                           //to_date[i].focus();
                                           return false;
                                       }
                                       if (b2b[i].value.trim() === "" && b2c[i].value.trim() === "") {
                                           alert('Please enter B2B or B2C value');
                                           //to_date[i].focus();
                                           return false;
                                       }
//        var textboxdis = $(inventory[i]).attr('disabled');
//        if(!textboxdis && textboxdis !== 'undefined'){
//            if (inventory[i].value.trim() === "") {
//                alert('Please enter total inventory');
//                inventory[i].focus();
//                return false;
//            }
//        }
                                   }


                               });
                               function getFormattedDate(date) {
                                   var getdates = new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1);
                                   var year = getdates.getFullYear();
                                   var month = (1 + getdates.getMonth()).toString();
                                   month = month.length > 1 ? month : '0' + month;
                                   var day = getdates.getDate().toString();
                                   day = day.length > 1 ? day : '0' + day;
                                   //return getdates.getFullYear()+"/"+(1+getdates.getMonth())+"/"+getdates.getDate();  
                                   return day + '/' + month + '/' + year;
                               }
                               function getFormattedDate2(date) {
                                   var getdates = new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1);
                                   var year = getdates.getFullYear();
                                   var month = (1 + getdates.getMonth()).toString();
                                   month = month.length > 1 ? month : '0' + month;
                                   var day = getdates.getDate().toString();
                                   day = day.length > 1 ? day : '0' + day;
                                   //return getdates.getFullYear()+"/"+(1+getdates.getMonth())+"/"+getdates.getDate();  
                                   return day + '/' + month + '/' + year;
                               }

                               $(document).ready(function () {
                                   var counter = '<?php echo!empty($from_date) ? count($from_date) : '0'; ?>';
                                   $("#addButton").click(function () {
                                       var newTextBoxTr = $(document.createElement('tr')).attr("id", 'Row' + counter);
                                       newTextBoxTr.after().html('<td><input name="from_date[]" id="from_date' + counter + '" type="text" class="form-control ratetxtwidth70 whbg "></td>' +
                                               ' <td <?php echo $hideTodate; ?>><input name="to_date[]" id="to_date' + counter + '" type="text" class="form-control ratetxtwidth70 whbg "></td>' +
                                               ' <td>' +
                                               '   <select id="ComssnType' + counter + '" name="ComssnType[]" class="form-control " placeholder="Select" >' +
                                               '     <option value="FixedAmount" >Fixed Amount</option>' +
                                               '    <option value="FixedPercent" >Fixed %</option>' +
                                               ' </select>' +
                                               ' </td>' +
                                               ' <td><input name="b2c[]" index="' + counter + '" id="b2c' + counter + '" onkeypress="return isNumber(event);" type="text" class="form-control ratetxtwidth70 whbg input0 markupvalidate"></td>' +
                                               ' <td><input name="b2b[]" index="' + counter + '" id="b2b' + counter + '" onkeypress="return isNumber(event);" type="text" class="form-control ratetxtwidth70 whbg input0 markupvalidate"></td>' +
                                               '<td style="display:none;"><input name="inventory[]" <?= $inventorydisable ?> id="inventory' + counter + '" onkeypress="return isNumber(event);" type="text" class="form-control ratetxtwidth70 whbg input0"></td><td><span class="removeButton btn ls-red-btn btn-sm" title="Remove"><i class="fa fa-trash-o"></i></span></td>');
                                       newTextBoxTr.appendTo("#RowsGroup");
                                       if (counter >= 1) {
                                           var negcounter = (counter - 1);
                                       } else {
                                           $('.removeButton').hide();
                                           var negcounter = (counter);
                                       }

                                       var poscounter = (parseInt(counter) + parseInt(1));

                                       var from_date = $('#from_date' + counter).datetimepicker({
                                           timepicker: false,
                                           datepicker: true,
                                           formatDate: 'd/m/Y',
                                           format: 'd/m/Y',
                                           minDate: 0,
                                           mask: true,
                                           defaultSelect: false,
                                           onChangeDateTime: function (d) {
                                               var lastfromdate = $('#from_date' + negcounter).val();
                                               var lasttodate = $('#to_date' + negcounter).val();
                                               var fromd = lastfromdate.split('/');
                                               var tod = lasttodate.split('/');
                                               fromd = new Date(fromd[2] + '/' + fromd[1] + '/' + fromd[0]);
                                               tod = new Date(tod[2] + '/' + tod[1] + '/' + tod[0]);

                                               if (negcounter !== '0' && d < tod) {
                                                   alert('Sorry from date should be greater than ' + lasttodate);
                                                   from_date.datetimepicker({value: '__/__/____'});
                                                   to_date.datetimepicker({value: '__/__/____'});
                                               }


                                               var day = d.getDate(); // month (in integer 0-11)
                                               var day2 = d.getDate(); // month (in integer 0-11)
                                               var month = d.getMonth() + 1; // month (in integer 0-11)
                                               var year = d.getFullYear(); // year
                                               to_date.datetimepicker({value: getFormattedDate(d)});
                                               to_date.datetimepicker({minDate: day + "/" + month + "/" + year});
                                           },
                                           onShow: function (ct) {
                                               var lastindextodate = $('#to_date' + negcounter).val();
                                               if (lastindextodate === 'undefined') {
                                               } else {
                                                   var ntodate = lastindextodate.split('/');
                                                   var actualDate = new Date(ntodate[2] + '/' + ntodate[1] + '/' + ntodate[0]);
                                                   var newdate = getFormattedDate2(actualDate);
                                                   this.setOptions({
                                                       minDate: newdate
                                                   });
                                               }
                                           }

                                       });

                                       var to_date = $('#to_date' + counter).datetimepicker({
                                           timepicker: false,
                                           datepicker: true,
                                           defaultDate: false,
                                           formatDate: 'd/m/Y',
                                           format: 'd/m/Y',
                                           mask: true,
                                           defaultSelect: false,
                                           onChangeDateTime: function (d) {

//            console.log(lastindexdate);
//            if(lastindexdate !== 'undefined'){
//                var ntodate = lastindexdate.split('-');
//                var actualDate = new Date(ntodate[2]+'-'+ntodate[1]+'-'+ntodate[0]);
//                console.log(lastindexdate);
//            }
                                               var newdates = getFormattedDate2(d)
                                               $('#from_date' + poscounter).datetimepicker({minDate: newdates});
                                               //from_date.datetimepicker({value: getFormattedDate(d)});

                                           },
                                           onShow: function (ct) {
                                               var day = ct.getDate(); // month (in integer 0-11)
                                               var day2 = ct.getDate(); // month (in integer 0-11)
                                               var month = ct.getMonth() + 1; // month (in integer 0-11)
                                               var year = ct.getFullYear(); // year

                                               this.setOptions({
                                                   value: ($('#to').val() !== '' && $('#to').val() !== '') ? $('#to').val() : '',
                                                   minDate: ($('#from').val() !== '' && $('#from').val() !== '') ? $('#from').val() : false,
                                                   //maxDate: ($('#from').val() != '' && $('#from').val() != '') ? todate : false,
                                                   //minDate: year + "/" + month + "/" + day,
                                                   //maxDate: year + "/" + month + "/" + day2 todate
                                               });

                                           }
                                       });




                                       counter++;
                                   });
                                   $("#RowsGroup").on('click', '.removeButton', function () {
                                       if (confirm('If you want to delete rates for this season kindly delete it from below season table. This will only delete the season not the rates. Are you sure you want to delete this season?')) {
                                           $(this).parent().parent().remove();
                                           counter--;
                                       }
                                   });

                                   $(document).on('keyup', '.markupvalidate', function () {
                                       var val = $(this).val();
                                       var index = $(this).attr('index');
                                       var ComssnType = $('#ComssnType' + index).val().trim();
                                       if (ComssnType === 'FixedPercent') {
                                           if (val.length > 2) {
                                               alert('Percentage value should be in two digit!!');
                                               $(this).val('');
                                               return false;
                                           }
                                       }

                                   });


<?php if (!$from_date) { ?>
                                       $('#addButton').trigger('click');
<?php } ?>

                               });

                               $(".input0").keyup(function () {
                                   if ($(this).val().trim() === '0') {
                                       $(this).val('');
                                       return false;
                                   }
                               });


</script>
</body>
</html>
